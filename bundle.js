!function(t){var e={};function o(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=e,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(s,n,function(e){return t[e]}.bind(null,n));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=5)}([function(t,e,o){o(1);function s({pos:t,vel:e,radius:o,color:s}){this.pos=t,this.vel=e,this.radius=o,this.color=s}s.prototype.draw=function(t){const[e,o]=this.pos;t.fillStyle=this.color,t.beginPath(),t.arc(e,o,this.radius,0,2*Math.PI),t.fill()},s.prototype.move=function(t){const[e,o]=this.pos,[s,n]=this.vel;this.pos=t([e+s,o+n])},s.prototype.isWrappable=!0,s.prototype.isCollidedWith=function(t){const[e,o]=this.pos,[s,n]=t.pos;return Math.sqrt((e-s)**2+(o-n)**2)<this.radius+t.radius},t.exports=s},function(t,e,o){const s=o(7),n=o(8),i=(o(0),o(4)),r=o(3),a=function(){this.controlMode="polar",this.movingObjects=new Set;for(let t=0;t<a.NUM_ASTEROIDS;t++){const t=this.randomPosition(),e=new s({pos:t});this.add(e)}const t=this.randomPosition();this.ship=new n({pos:t},this),this.bullets=new Set,this.keyStatus=0};a.prototype.add=function(t){t instanceof s?this.movingObjects.add(t):t instanceof i&&this.bullets.add(t)},a.prototype.remove=function(t){t instanceof s?this.movingObjects.delete(t):t instanceof i&&this.bullets.delete(t)},a.prototype.getControlMode=function(){return this.controlMode},a.prototype.setControlMode=function(t){this.controlMode=t,this.ship.updateControl()},a.prototype.randomPosition=function(){return[Math.random()*r.DIM_X,Math.random()*r.DIM_Y]},a.prototype.draw=function(t){t.clearRect(0,0,r.DIM_X,r.DIM_Y),this.allObjects().forEach(e=>e.draw(t))},a.prototype.moveObjects=function(){this.ship.control(this.keyStatus),this.keyStatus&r.spaceMask&&this.ship.fireBullet(),this.allObjects().forEach(t=>{t.isWrappable?t.move(this.wrap):t.move(e=>(this.isOutOfBounds(e)&&this.remove(t),e))})},a.prototype.wrap=function([t,e]){return[(t+r.DIM_X)%r.DIM_X,(e+r.DIM_Y)%r.DIM_Y]},a.prototype.checkCollisions=function(){this.movingObjects.forEach(t=>{this.ship.isCollidedWith(t)&&(this.relocate(this.ship),this.ship.reset())}),this.bullets.forEach(t=>{this.movingObjects.forEach(e=>{t.isCollidedWith(e)&&(this.remove(e),this.remove(t))})})},a.prototype.step=function(){this.moveObjects(),this.checkCollisions()},a.prototype.relocate=function(t){t.pos=this.randomPosition()},a.prototype.allObjects=function(){return[...this.movingObjects,this.ship,...this.bullets]},a.prototype.isOutOfBounds=function(t){const[e,o]=t;return e>a.DIM_X||e<0||o>a.DIM_Y||o<0},a.NUM_ASTEROIDS=20,t.exports=a},function(t,e){const o={inherits(t,e){const o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t},randomVec(t){const e=2*Math.PI*Math.random();return o.scale([Math.sin(e),Math.cos(e)],t)},scale:(t,e)=>[t[0]*e,t[1]*e],magnitudeSqOf(t){const[e,o]=t;return e**2+o**2},magnitudeOf(t){return Math.sqrt(this.magnitudeSqOf(t))},unitVectorOf(t){const e=this.magnitudeOf(t);return e?this.scale(t,1/e):t},extendVector(t,e){const o=this.magnitudeOf(t);if(o){const s=o+e;return this.scale(this.scale(t,1/o),s)}return null},rotate(t,e){const[o,s]=t;return[o*Math.cos(e)-s*Math.sin(e),o*Math.sin(e)+s*Math.cos(e)]}};t.exports=o},function(t,e){t.exports={DIM_X:768,DIM_Y:512,wMask:1,aMask:2,sMask:4,dMask:8,spaceMask:16,SPEED_INTERVAL:.25}},function(t,e,o){const s=o(0),n=o(2),i=function({pos:t,vel:e}){s.call(this,{pos:t,vel:e,radius:i.RADIUS,color:i.COLOR}),this.isWrappable=!1};i.RADIUS=2,i.COLOR="white",n.inherits(i,s),t.exports=i},function(t,e,o){"use strict";o.r(e);o(9);const s=o(6);document.addEventListener("DOMContentLoaded",(function(){(new s).start()}))},function(t,e,o){const s=o(1),n=o(3),i=function(){const t=document.getElementById("app-container");this.game=new s;const e=document.createElement("canvas"),o=e.getContext("2d"),i=window.devicePixelRatio;e.width=n.DIM_X*i,e.height=n.DIM_Y*i,e.id="main-canvas",o.scale(i,i),e.tabIndex=1,e.autofocus=!0,t.appendChild(e);const r=function(){a.innerText=`Switch to ${this.getControlMode()} mode`,this.setControlMode("polar"===this.getControlMode()?"cartesian":"polar")}.bind(this.game),a=document.createElement("button");a.onclick=r,a.innerText=`Switch to ${"polar"===this.game.getControlMode()?"cartesian":"polar"} mode`,t.appendChild(a),this.context=o,this.canvas=e;(function(){e.addEventListener("keydown",t=>{switch(t.key){case"w":this.keyStatus|=n.wMask;break;case"a":this.keyStatus|=n.aMask;break;case"s":this.keyStatus|=n.sMask;break;case"d":this.keyStatus|=n.dMask;break;case" ":this.keyStatus|=n.spaceMask}}),e.addEventListener("keyup",t=>{switch(t.key){case"w":this.keyStatus&=~n.wMask;break;case"a":this.keyStatus&=~n.aMask;break;case"s":this.keyStatus&=~n.sMask;break;case"d":this.keyStatus&=~n.dMask;break;case" ":this.keyStatus&=~n.spaceMask;break;case"Escape":r()}})}).bind(this.game)()};i.prototype.start=function(){const t=()=>{this.game.step(),this.game.draw(this.context),requestAnimationFrame(t)};t()},i.prototype.bindKeyHandlers=function(){key("W",()=>{this.game.ship.power([0,-1])}),key("S",()=>{this.game.ship.power([0,1])}),key("A",()=>{this.game.ship.power([-1,0])}),key("D",()=>{this.game.ship.power([1,0])}),key("space",()=>{this.game.ship.fireBullet()})},t.exports=i},function(t,e,o){const s=o(2),n=o(0),i=function({pos:t}){n.call(this,{pos:t,vel:s.randomVec(6*Math.random()+1),color:i.COLOR,radius:i.RADIUS})};i.COLOR="#666666",i.RADIUS=20,s.inherits(i,n),t.exports=i},function(t,e,o){const s=o(2),n=o(0),i=(o(1),o(4)),r=o(3),a=function({pos:t},e){n.call(this,{pos:t,radius:a.RADIUS,color:a.COLOR,vel:[0,0]}),this.game=e,this.updateControl()};a.RADIUS=15,a.COLOR="#31a5d9",s.inherits(a,n),a.prototype.reset=function(){this.vel=[0,0]},a.prototype.updateControl=function(){this.controller=function(t){if("polar"===t){let t=0,e=0;return o=>(o&r.wMask&&(e+=r.SPEED_INTERVAL),o&r.aMask&&(t-=r.SPEED_INTERVAL/2),o&r.sMask&&(e-=r.SPEED_INTERVAL),o&r.dMask&&(t+=r.SPEED_INTERVAL/2),s.rotate(s.extendVector([1,0],e),t))}{let t=0,e=0;return o=>(o&r.wMask&&(e-=r.SPEED_INTERVAL),o&r.aMask&&(t-=r.SPEED_INTERVAL),o&r.sMask&&(e+=r.SPEED_INTERVAL),o&r.dMask&&(t+=r.SPEED_INTERVAL),[t,e])}}(this.game.getControlMode())},a.prototype.control=function(t){this.vel=this.controller(t)},a.prototype.fireBullet=function(){const t=this.pos,e=s.extendVector(this.vel,10)||[0,10],o=new i({pos:t,vel:e});this.game.add(o)},t.exports=a},function(t,e,o){}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vdmluZ19vYmplY3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb25zdHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2J1bGxldC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWVfdmlldy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYXN0ZXJvaWQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NoaXAuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJNb3ZpbmdPYmplY3QiLCJwb3MiLCJ2ZWwiLCJyYWRpdXMiLCJjb2xvciIsInRoaXMiLCJkcmF3IiwiY29udGV4dCIsIngiLCJ5IiwiZmlsbFN0eWxlIiwiYmVnaW5QYXRoIiwiYXJjIiwiTWF0aCIsIlBJIiwiZmlsbCIsIm1vdmUiLCJwb3NDYWxsQmFjayIsImR4IiwiZHkiLCJpc1dyYXBwYWJsZSIsImlzQ29sbGlkZWRXaXRoIiwib3RoZXJPYmplY3QiLCJ4MSIsInkxIiwieDIiLCJ5MiIsInNxcnQiLCJBc3Rlcm9pZCIsIlNoaXAiLCJCdWxsZXQiLCJDb25zdHMiLCJHYW1lIiwiY29udHJvbE1vZGUiLCJtb3ZpbmdPYmplY3RzIiwiU2V0IiwiTlVNX0FTVEVST0lEUyIsInJhbmRvbVBvc2l0aW9uIiwiYXN0ZXJvaWQiLCJhZGQiLCJzaGlwIiwiYnVsbGV0cyIsImtleVN0YXR1cyIsInJlbW92ZSIsImRlbGV0ZSIsImdldENvbnRyb2xNb2RlIiwic2V0Q29udHJvbE1vZGUiLCJ1cGRhdGVDb250cm9sIiwicmFuZG9tIiwiRElNX1giLCJESU1fWSIsImNsZWFyUmVjdCIsImFsbE9iamVjdHMiLCJmb3JFYWNoIiwibW92ZU9iamVjdHMiLCJjb250cm9sIiwic3BhY2VNYXNrIiwiZmlyZUJ1bGxldCIsIndyYXAiLCJpc091dE9mQm91bmRzIiwiY2hlY2tDb2xsaXNpb25zIiwicmVsb2NhdGUiLCJyZXNldCIsImIiLCJzdGVwIiwiVXRpbCIsIkNoaWxkQ2xhc3MiLCJQYXJlbnRDbGFzcyIsIlN1cnJvZ2F0ZSIsImNvbnN0cnVjdG9yIiwibGVuZ3RoIiwiZGVnIiwic2NhbGUiLCJzaW4iLCJjb3MiLCJ2ZWMiLCJ2ZWN0b3IiLCJtYWduaXR1ZGVTcU9mIiwibWFnbml0dWRlIiwibWFnbml0dWRlT2YiLCJleHRlbmRlZE1hZ25pdHVkZSIsInRoZXRhIiwid01hc2siLCJhTWFzayIsInNNYXNrIiwiZE1hc2siLCJTUEVFRF9JTlRFUlZBTCIsIlJBRElVUyIsIkNPTE9SIiwiaW5oZXJpdHMiLCJHYW1lVmlldyIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0YXJ0IiwiYXBwQ29udGFpbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJnYW1lIiwiY2FudmFzIiwiY3JlYXRlRWxlbWVudCIsImdldENvbnRleHQiLCJkcHIiLCJ3aW5kb3ciLCJkZXZpY2VQaXhlbFJhdGlvIiwid2lkdGgiLCJoZWlnaHQiLCJpZCIsInRhYkluZGV4IiwiYXV0b2ZvY3VzIiwiYXBwZW5kQ2hpbGQiLCJzd2l0Y2hNb2RlQWN0aW9uIiwic3dpdGNoTW9kZUJ1dHRvbiIsImlubmVyVGV4dCIsIm9uY2xpY2siLCJldmVudCIsImtleWJpbmRpbmdzIiwicmVmcmVzaCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImJpbmRLZXlIYW5kbGVycyIsInBvd2VyIiwicmFuZG9tVmVjIiwiQ29uc3QiLCJjb250cm9sbGVyIiwic3BlZWQiLCJyb3RhdGUiLCJleHRlbmRWZWN0b3IiLCJjb250cm9sU2NoZW1lIiwiYnVsbGV0Il0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElB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RCxHQUFNcUcsRUFBTWxDLGdCQUNyQzVDLEVBQVk4RSxFQUFNckMsUUFBT2pFLEdBQU1zRyxFQUFNbEMsZ0JBQ3JDNUMsRUFBWThFLEVBQU1wQyxRQUFPakUsR0FBTXFHLEVBQU1sQyxnQkFDckM1QyxFQUFZOEUsRUFBTW5DLFFBQU9uRSxHQUFNc0csRUFBTWxDLGdCQUNsQyxDQUFDcEUsRUFBSUMsS0FqREUwRyxDQUFjeEgsS0FBSzJGLEtBQUtuRCxtQkFNNUNoQixFQUFLakMsVUFBVTJELFFBQVUsU0FBVWIsR0FDakNyQyxLQUFLSCxJQUFNRyxLQUFLb0gsV0FBVy9FLElBRzdCYixFQUFLakMsVUFBVTZELFdBQWEsV0FFMUIsTUFBTXhELEVBQU1JLEtBQUtKLElBQ1hDLEVBQU0rRCxFQUFLMkQsYUFBYXZILEtBQUtILElBQUssS0FBTyxDQUFDLEVBQUcsSUFDN0M0SCxFQUFTLElBQUloRyxFQUFPLENBQUM3QixNQUFLQyxRQUVoQ0csS0FBSzJGLEtBQUt6RCxJQUFJdUYsSUFzQ2hCL0osRUFBT0QsUUFBVStELEciLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDUpO1xuIiwiY29uc3QgR2FtZSA9IHJlcXVpcmUoJy4vZ2FtZScpO1xuXG4vKipcbiAqIFxuICogQHBhcmFtIHt7cG9zOiBbbnVtYmVyLCBudW1iZXJdLCB2ZWw6IFtudW1iZXIsIG51bWJlcl0sIHJhZGl1czogbnVtYmVyLCBjb2xvcjogc3RyaW5nfX0gcGFyYW0wIG9wdGlvbiBvYmplY3RcbiAqIEBwYXJhbSB7R2FtZX0gZ2FtZVxuICovXG5mdW5jdGlvbiBNb3ZpbmdPYmplY3Qoe3BvcywgdmVsLCByYWRpdXMsIGNvbG9yfSkge1xuICB0aGlzLnBvcyA9IHBvcztcbiAgdGhpcy52ZWwgPSB2ZWw7XG4gIHRoaXMucmFkaXVzID0gcmFkaXVzO1xuICB0aGlzLmNvbG9yID0gY29sb3I7XG59XG5cbi8qKlxuICogQHBhcmFtIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9IGNvbnRleHRcbiAqL1xuXG5Nb3ZpbmdPYmplY3QucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbihjb250ZXh0KSB7XG4gIGNvbnN0IFt4LCB5XSA9IHRoaXMucG9zO1xuICBjb250ZXh0LmZpbGxTdHlsZSA9IHRoaXMuY29sb3I7XG4gIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gIGNvbnRleHQuYXJjKFxuICAgIHgsIHksIHRoaXMucmFkaXVzLCAwLCAyICogTWF0aC5QSVxuICApO1xuICBjb250ZXh0LmZpbGwoKTtcbn07XG5cbk1vdmluZ09iamVjdC5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uKHBvc0NhbGxCYWNrKSB7XG4gIGNvbnN0IFt4LCB5XSA9IHRoaXMucG9zO1xuICBjb25zdCBbZHgsIGR5XSA9IHRoaXMudmVsO1xuICB0aGlzLnBvcyA9IHBvc0NhbGxCYWNrKFt4ICsgZHgsIHkgKyBkeV0pO1xufTtcblxuTW92aW5nT2JqZWN0LnByb3RvdHlwZS5pc1dyYXBwYWJsZSA9IHRydWU7XG5cbi8qKlxuICogQHBhcmFtIHtNb3ZpbmdPYmplY3R9IG90aGVyT2JqZWN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAqL1xuTW92aW5nT2JqZWN0LnByb3RvdHlwZS5pc0NvbGxpZGVkV2l0aCA9IGZ1bmN0aW9uIChvdGhlck9iamVjdCkge1xuICBjb25zdCBbeDEsIHkxXSA9IHRoaXMucG9zO1xuICBjb25zdCBbeDIsIHkyXSA9IG90aGVyT2JqZWN0LnBvcztcbiAgcmV0dXJuIE1hdGguc3FydCgoeDEgLSB4MikgKiogMiArICh5MSAtIHkyKSAqKiAyKSA8IHRoaXMucmFkaXVzICsgb3RoZXJPYmplY3QucmFkaXVzO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBNb3ZpbmdPYmplY3Q7XG4iLCJjb25zdCBBc3Rlcm9pZCA9IHJlcXVpcmUoXCIuL2FzdGVyb2lkLmpzXCIpO1xuY29uc3QgU2hpcCA9IHJlcXVpcmUoXCIuL3NoaXBcIik7XG5jb25zdCBNb3ZpbmdPYmplY3QgPSByZXF1aXJlKFwiLi9tb3Zpbmdfb2JqZWN0XCIpO1xuY29uc3QgQnVsbGV0ID0gcmVxdWlyZSgnLi9idWxsZXQnKTtcbmNvbnN0IENvbnN0cyA9IHJlcXVpcmUoJy4vY29uc3RzJyk7XG5cbmNvbnN0IEdhbWUgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuY29udHJvbE1vZGUgPSAncG9sYXInO1xuICB0aGlzLm1vdmluZ09iamVjdHMgPSBuZXcgU2V0KCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgR2FtZS5OVU1fQVNURVJPSURTOyBpKyspIHtcbiAgICBjb25zdCBwb3MgPSB0aGlzLnJhbmRvbVBvc2l0aW9uKCk7XG4gICAgY29uc3QgYXN0ZXJvaWQgPSBuZXcgQXN0ZXJvaWQoeyBwb3MgfSk7XG4gICAgdGhpcy5hZGQoYXN0ZXJvaWQpO1xuICB9XG4gIGNvbnN0IHBvcyA9IHRoaXMucmFuZG9tUG9zaXRpb24oKTtcbiAgdGhpcy5zaGlwID0gbmV3IFNoaXAoeyBwb3MgfSwgdGhpcyk7XG4gIHRoaXMuYnVsbGV0cyA9IG5ldyBTZXQoKTtcbiAgdGhpcy5rZXlTdGF0dXMgPSAwO1xufVxuXG5HYW1lLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAob2JqZWN0KSB7XG4gIGlmIChvYmplY3QgaW5zdGFuY2VvZiBBc3Rlcm9pZCkge1xuICAgIHRoaXMubW92aW5nT2JqZWN0cy5hZGQob2JqZWN0KTtcbiAgfSBlbHNlIGlmIChvYmplY3QgaW5zdGFuY2VvZiBCdWxsZXQpIHtcbiAgICB0aGlzLmJ1bGxldHMuYWRkKG9iamVjdCk7XG4gIH1cbn1cblxuR2FtZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICBpZiAob2JqZWN0IGluc3RhbmNlb2YgQXN0ZXJvaWQpIHtcbiAgICB0aGlzLm1vdmluZ09iamVjdHMuZGVsZXRlKG9iamVjdCk7XG4gIH0gZWxzZSBpZiAob2JqZWN0IGluc3RhbmNlb2YgQnVsbGV0KSB7XG4gICAgdGhpcy5idWxsZXRzLmRlbGV0ZShvYmplY3QpO1xuICB9XG59XG5cbkdhbWUucHJvdG90eXBlLmdldENvbnRyb2xNb2RlID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLmNvbnRyb2xNb2RlO1xufVxuXG5HYW1lLnByb3RvdHlwZS5zZXRDb250cm9sTW9kZSA9IGZ1bmN0aW9uKG1vZGUpIHtcbiAgdGhpcy5jb250cm9sTW9kZSA9IG1vZGU7XG4gIHRoaXMuc2hpcC51cGRhdGVDb250cm9sKCk7XG59XG5cbkdhbWUucHJvdG90eXBlLnJhbmRvbVBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xuICByZXR1cm4gWyhNYXRoLnJhbmRvbSgpICogQ29uc3RzLkRJTV9YKSwgKE1hdGgucmFuZG9tKCkgKiBDb25zdHMuRElNX1kpXTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gY29udGV4dFxuICovXG5HYW1lLnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgQ29uc3RzLkRJTV9YLCBDb25zdHMuRElNX1kpO1xuICB0aGlzLmFsbE9iamVjdHMoKS5mb3JFYWNoKG8gPT4gby5kcmF3KGNvbnRleHQpKTtcbn1cblxuR2FtZS5wcm90b3R5cGUubW92ZU9iamVjdHMgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMuc2hpcC5jb250cm9sKHRoaXMua2V5U3RhdHVzKTtcbiAgaWYgKHRoaXMua2V5U3RhdHVzICYgQ29uc3RzLnNwYWNlTWFzaykgdGhpcy5zaGlwLmZpcmVCdWxsZXQoKTtcbiAgdGhpcy5hbGxPYmplY3RzKCkuZm9yRWFjaChvID0+IHtcbiAgICBpZiAoby5pc1dyYXBwYWJsZSkge1xuICAgICAgby5tb3ZlKHRoaXMud3JhcCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG8ubW92ZShwb3MgPT4ge1xuICAgICAgICBpZiAodGhpcy5pc091dE9mQm91bmRzKHBvcykpIHRoaXMucmVtb3ZlKG8pO1xuICAgICAgICByZXR1cm4gcG9zO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge1tudW1iZXIsIG51bWJlcl19XG4gKiBAcmV0dXJucyB7W251bWJlciwgbnVtYmVyXX1cbiAqL1xuR2FtZS5wcm90b3R5cGUud3JhcCA9IGZ1bmN0aW9uIChbeCwgeV0pIHtcbiAgcmV0dXJuIFsoeCArIENvbnN0cy5ESU1fWCkgJSBDb25zdHMuRElNX1gsICh5ICsgQ29uc3RzLkRJTV9ZKSAlIENvbnN0cy5ESU1fWV07XG59XG5cbkdhbWUucHJvdG90eXBlLmNoZWNrQ29sbGlzaW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5tb3ZpbmdPYmplY3RzLmZvckVhY2gobyA9PiB7XG4gICAgaWYgKHRoaXMuc2hpcC5pc0NvbGxpZGVkV2l0aChvKSkge1xuICAgICAgdGhpcy5yZWxvY2F0ZSh0aGlzLnNoaXApO1xuICAgICAgdGhpcy5zaGlwLnJlc2V0KCk7XG4gICAgfVxuICB9KVxuICB0aGlzLmJ1bGxldHMuZm9yRWFjaChiID0+IHtcbiAgICB0aGlzLm1vdmluZ09iamVjdHMuZm9yRWFjaChvID0+IHtcbiAgICAgIGlmIChiLmlzQ29sbGlkZWRXaXRoKG8pKSB7XG4gICAgICAgIHRoaXMucmVtb3ZlKG8pO1xuICAgICAgICB0aGlzLnJlbW92ZShiKTtcbiAgICAgIH1cbiAgICB9KVxuICB9KVxufVxuXG5HYW1lLnByb3RvdHlwZS5zdGVwID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLm1vdmVPYmplY3RzKCk7XG4gIHRoaXMuY2hlY2tDb2xsaXNpb25zKCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtNb3ZpbmdPYmplY3R9IG9iamVjdFxuICovXG5HYW1lLnByb3RvdHlwZS5yZWxvY2F0ZSA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgb2JqZWN0LnBvcyA9IHRoaXMucmFuZG9tUG9zaXRpb24oKTtcbn1cblxuLyoqXG4gKiBAcmV0dXJucyB7QXJyYXk8TW92aW5nT2JqZWN0Pn1cbiAqL1xuR2FtZS5wcm90b3R5cGUuYWxsT2JqZWN0cyA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIFsuLi50aGlzLm1vdmluZ09iamVjdHMsIHRoaXMuc2hpcCwgLi4udGhpcy5idWxsZXRzXTtcbn1cblxuR2FtZS5wcm90b3R5cGUuaXNPdXRPZkJvdW5kcyA9IGZ1bmN0aW9uKHBvcykge1xuICBjb25zdCBbeCwgeV0gPSBwb3M7XG4gIHJldHVybiB4ID4gR2FtZS5ESU1fWCB8fCB4IDwgMCB8fCB5ID4gR2FtZS5ESU1fWSB8fCB5IDwgMDtcbn1cblxuR2FtZS5OVU1fQVNURVJPSURTID0gMjA7XG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZTtcbiIsImNvbnN0IFV0aWwgPSB7XG4gIGluaGVyaXRzKENoaWxkQ2xhc3MsIFBhcmVudENsYXNzKSB7XG4gICAgY29uc3QgU3Vycm9nYXRlID0gZnVuY3Rpb24oKSB7fTtcbiAgICBTdXJyb2dhdGUucHJvdG90eXBlID0gUGFyZW50Q2xhc3MucHJvdG90eXBlO1xuICAgIENoaWxkQ2xhc3MucHJvdG90eXBlID0gbmV3IFN1cnJvZ2F0ZSgpO1xuICAgIENoaWxkQ2xhc3MucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gQ2hpbGRDbGFzcztcbiAgfSxcbiAgcmFuZG9tVmVjKGxlbmd0aCkge1xuICAgIGNvbnN0IGRlZyA9IDIgKiBNYXRoLlBJICogTWF0aC5yYW5kb20oKTtcbiAgICByZXR1cm4gVXRpbC5zY2FsZShbTWF0aC5zaW4oZGVnKSwgTWF0aC5jb3MoZGVnKV0sIGxlbmd0aCk7XG4gIH0sXG4gIC8vIFNjYWxlIHRoZSBsZW5ndGggb2YgYSB2ZWN0b3IgYnkgdGhlIGdpdmVuIGFtb3VudC5cbiAgc2NhbGUodmVjLCBtKSB7XG4gICAgcmV0dXJuIFt2ZWNbMF0gKiBtLCB2ZWNbMV0gKiBtXTtcbiAgfSxcbiAgLyoqXG4gICAqIEBwYXJhbSB7W251bWJlciwgbnVtYmVyXX0gdmVjdG9yXG4gICAqL1xuICBtYWduaXR1ZGVTcU9mKHZlY3Rvcikge1xuICAgIGNvbnN0IFt4LCB5XSA9IHZlY3RvcjtcbiAgICByZXR1cm4geCAqKiAyICsgeSAqKiAyO1xuICB9LFxuICAvKipcbiAgICogQHBhcmFtIHtbbnVtYmVyLCBudW1iZXJdfSB2ZWN0b3JcbiAgICovXG4gIG1hZ25pdHVkZU9mKHZlY3Rvcikge1xuICAgIHJldHVybiBNYXRoLnNxcnQodGhpcy5tYWduaXR1ZGVTcU9mKHZlY3RvcikpO1xuICB9LFxuICAvKipcbiAgICogQHBhcmFtIHtbbnVtYmVyLCBudW1iZXJdfSB2ZWN0b3JcbiAgICogQHJldHVybnMge1tudW1iZXIsIG51bWJlcl19IHRoZSB1bml0IHZlY3Rvci4gSW4gY2FzZSB3aGVyZSB0aGUgdmVjdG9yIGhhcyBhIGxlbmd0aCBvZiAwLCB0aGUgb3JpZ2luYWwgdmVjdG9yIHdpbGwgYmUgcmV0dXJuZWRcbiAgICovXG4gIHVuaXRWZWN0b3JPZih2ZWN0b3IpIHtcbiAgICBjb25zdCBtYWduaXR1ZGUgPSB0aGlzLm1hZ25pdHVkZU9mKHZlY3Rvcik7XG4gICAgcmV0dXJuIG1hZ25pdHVkZSA/IHRoaXMuc2NhbGUodmVjdG9yLCAxIC8gbWFnbml0dWRlKSA6IHZlY3RvcjtcbiAgfSxcbiAgLyoqXG4gICAqIFJldHVybnMgYW4gbmV3IHZlY3RvciB3aGljaCBsZW5ndGggaXMgYGxlbmd0aGAgbG9uZ2VyIHRoYW4gdGhlIHByb3ZpZGVkIHZlY3Rvci5cbiAgICogV2hlbiBnaXZlbiBhIDAgdmVjdG9yLCB0aGlzIHJldHVybnMgbnVsbC5cbiAgICpcbiAgICogQHBhcmFtIHtbbnVtYmVyLCBudW1iZXJdfSB2ZWN0b3IgdGhlIHJlZmVyZW5jZSB2ZWN0b3JcbiAgICogQHBhcmFtIHtudW1iZXJ9IGxlbmd0aCB0aGUgbGVuZ3RoIHRvIGV4dGVuZFxuICAgKiBAcmV0dXJucyB7W251bWJlciwgbnVtYmVyXXxudWxsfVxuICAgKi9cbiAgZXh0ZW5kVmVjdG9yKHZlY3RvciwgbGVuZ3RoKSB7XG4gICAgY29uc3QgbWFnbml0dWRlID0gdGhpcy5tYWduaXR1ZGVPZih2ZWN0b3IpO1xuICAgIGlmIChtYWduaXR1ZGUpIHtcbiAgICAgIGNvbnN0IGV4dGVuZGVkTWFnbml0dWRlID0gbWFnbml0dWRlICsgbGVuZ3RoO1xuICAgICAgcmV0dXJuIHRoaXMuc2NhbGUodGhpcy5zY2FsZSh2ZWN0b3IsIDEgLyBtYWduaXR1ZGUpLCBleHRlbmRlZE1hZ25pdHVkZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfSxcbiAgcm90YXRlKHZlY3RvciwgdGhldGEpIHtcbiAgICBjb25zdCBbeCwgeV0gPSB2ZWN0b3I7XG4gICAgY29uc3QgeDIgPSB4ICogTWF0aC5jb3ModGhldGEpIC0geSAqIE1hdGguc2luKHRoZXRhKTtcbiAgICBjb25zdCB5MiA9IHggKiBNYXRoLnNpbih0aGV0YSkgKyB5ICogTWF0aC5jb3ModGhldGEpO1xuICAgIHJldHVybiBbeDIsIHkyXTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBVdGlsO1xuIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIERJTV9YOiA3NjgsXG4gIERJTV9ZOiA1MTIsXG4gIHdNYXNrOiAwYjEsXG4gIGFNYXNrOiAwYjEwLFxuICBzTWFzazogMGIxMDAsXG4gIGRNYXNrOiAwYjEwMDAsXG4gIHNwYWNlTWFzazogMGIxMDAwMCxcbiAgU1BFRURfSU5URVJWQUw6IDAuMjUsXG59XG4iLCJjb25zdCBNb3ZpbmdPYmplY3QgPSByZXF1aXJlKCcuL21vdmluZ19vYmplY3QnKTtcbmNvbnN0IFV0aWwgPSByZXF1aXJlKCcuL3V0aWxzJylcblxuY29uc3QgQnVsbGV0ID0gZnVuY3Rpb24oe3BvcywgdmVsfSkge1xuICBNb3ZpbmdPYmplY3QuY2FsbCh0aGlzLCB7cG9zLCB2ZWwsIHJhZGl1czogQnVsbGV0LlJBRElVUywgY29sb3I6IEJ1bGxldC5DT0xPUn0pO1xuICB0aGlzLmlzV3JhcHBhYmxlID0gZmFsc2U7XG59XG5cbkJ1bGxldC5SQURJVVMgPSAyO1xuQnVsbGV0LkNPTE9SID0gXCJ3aGl0ZVwiO1xuXG5VdGlsLmluaGVyaXRzKEJ1bGxldCwgTW92aW5nT2JqZWN0KTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gQnVsbGV0O1xuIiwiY29uc3QgR2FtZVZpZXcgPSByZXF1aXJlKFwiLi9nYW1lX3ZpZXdcIik7XG5pbXBvcnQgJy4uL2Nzcy9zdHlsZS5zY3NzJztcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oKSB7XG4gICAgY29uc3QgZ2FtZSA9IG5ldyBHYW1lVmlldygpO1xuICAgIGdhbWUuc3RhcnQoKTtcbn0pXG5cbiIsImNvbnN0IEdhbWUgPSByZXF1aXJlKFwiLi9nYW1lXCIpO1xuY29uc3QgQ29uc3RzID0gcmVxdWlyZShcIi4vY29uc3RzXCIpXG5cbmNvbnN0IEdhbWVWaWV3ID0gZnVuY3Rpb24gKCkge1xuXG4gIGNvbnN0IGFwcENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXBwLWNvbnRhaW5lclwiKTtcblxuICB0aGlzLmdhbWUgPSBuZXcgR2FtZSgpO1xuXG4gIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG4gIGNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXG4gIGNvbnN0IGRwciA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvO1xuICBjYW52YXMud2lkdGggPSBDb25zdHMuRElNX1ggKiBkcHI7XG4gIGNhbnZhcy5oZWlnaHQgPSBDb25zdHMuRElNX1kgKiBkcHI7XG4gIGNhbnZhcy5pZCA9IFwibWFpbi1jYW52YXNcIjtcbiAgY29udGV4dC5zY2FsZShkcHIsIGRwcik7XG4gIGNhbnZhcy50YWJJbmRleCA9IDE7XG4gIGNhbnZhcy5hdXRvZm9jdXMgPSB0cnVlO1xuICBhcHBDb250YWluZXIuYXBwZW5kQ2hpbGQoY2FudmFzKTtcblxuICBjb25zdCBzd2l0Y2hNb2RlQWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgIHN3aXRjaE1vZGVCdXR0b24uaW5uZXJUZXh0ID0gYFN3aXRjaCB0byAke3RoaXMuZ2V0Q29udHJvbE1vZGUoKX0gbW9kZWA7XG4gICAgdGhpcy5zZXRDb250cm9sTW9kZSh0aGlzLmdldENvbnRyb2xNb2RlKCkgPT09ICdwb2xhcicgPyAnY2FydGVzaWFuJyA6ICdwb2xhcicpO1xuICB9LmJpbmQodGhpcy5nYW1lKTtcblxuICBjb25zdCBzd2l0Y2hNb2RlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgc3dpdGNoTW9kZUJ1dHRvbi5vbmNsaWNrID0gc3dpdGNoTW9kZUFjdGlvbjtcbiAgc3dpdGNoTW9kZUJ1dHRvbi5pbm5lclRleHQgPSBgU3dpdGNoIHRvICR7dGhpcy5nYW1lLmdldENvbnRyb2xNb2RlKCkgPT09ICdwb2xhcicgPyAnY2FydGVzaWFuJyA6ICdwb2xhcid9IG1vZGVgO1xuICBhcHBDb250YWluZXIuYXBwZW5kQ2hpbGQoc3dpdGNoTW9kZUJ1dHRvbik7XG5cbiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgdGhpcy5jYW52YXMgPSBjYW52YXM7XG5cbiAgY29uc3Qga2V5YmluZGluZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgc3dpdGNoIChldmVudC5rZXkpIHtcbiAgICAgICAgY2FzZSAndyc6XG4gICAgICAgICAgdGhpcy5rZXlTdGF0dXMgfD0gQ29uc3RzLndNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdhJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyB8PSBDb25zdHMuYU1hc2s7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3MnOlxuICAgICAgICAgIHRoaXMua2V5U3RhdHVzIHw9IENvbnN0cy5zTWFzaztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZCc6XG4gICAgICAgICAgdGhpcy5rZXlTdGF0dXMgfD0gQ29uc3RzLmRNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICcgJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyB8PSBDb25zdHMuc3BhY2VNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBzd2l0Y2ggKGV2ZW50LmtleSkge1xuICAgICAgICBjYXNlICd3JzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+Q29uc3RzLndNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdhJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+Q29uc3RzLmFNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+Q29uc3RzLnNNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdkJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+Q29uc3RzLmRNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICcgJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+Q29uc3RzLnNwYWNlTWFzaztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRXNjYXBlJzpcbiAgICAgICAgICBzd2l0Y2hNb2RlQWN0aW9uKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSlcbiAgfS5iaW5kKHRoaXMuZ2FtZSk7XG5cbiAga2V5YmluZGluZ3MoKTtcblxufVxuXG5HYW1lVmlldy5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gIC8vIHRoaXMuYmluZEtleUhhbmRsZXJzKCk7XG4gIGNvbnN0IHJlZnJlc2ggPSAoKSA9PiB7XG4gICAgdGhpcy5nYW1lLnN0ZXAoKTtcbiAgICB0aGlzLmdhbWUuZHJhdyh0aGlzLmNvbnRleHQpO1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShyZWZyZXNoKTtcbiAgfVxuICByZWZyZXNoKCk7XG59XG5cbkdhbWVWaWV3LnByb3RvdHlwZS5iaW5kS2V5SGFuZGxlcnMgPSBmdW5jdGlvbiAoKSB7XG4gIGtleSgnVycsICgpID0+IHtcbiAgICB0aGlzLmdhbWUuc2hpcC5wb3dlcihbMCwgLTFdKTtcbiAgfSlcbiAga2V5KCdTJywgKCkgPT4ge1xuICAgIHRoaXMuZ2FtZS5zaGlwLnBvd2VyKFswLCAxXSk7XG4gIH0pXG4gIGtleSgnQScsICgpID0+IHtcbiAgICB0aGlzLmdhbWUuc2hpcC5wb3dlcihbLTEsIDBdKTtcbiAgfSlcbiAga2V5KCdEJywgKCkgPT4ge1xuICAgIHRoaXMuZ2FtZS5zaGlwLnBvd2VyKFsxLCAwXSk7XG4gIH0pXG4gIGtleShcInNwYWNlXCIsICgpID0+IHtcbiAgICB0aGlzLmdhbWUuc2hpcC5maXJlQnVsbGV0KCk7XG4gIH0pXG59XG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZVZpZXc7XG4iLCJjb25zdCBVdGlsID0gcmVxdWlyZSgnLi91dGlscycpXG5jb25zdCBNb3ZpbmdPYmplY3QgPSByZXF1aXJlKCcuL21vdmluZ19vYmplY3QnKTtcblxuLyoqXG4gKlxuICogQHBhcmFtIHt7cG9zOiBbbnVtYmVyLCBudW1iZXJdfX0gcGFyYW0wIG9wdGlvbnNcbiAqL1xuY29uc3QgQXN0ZXJvaWQgPSBmdW5jdGlvbiAoeyBwb3MgfSkge1xuICBNb3ZpbmdPYmplY3QuY2FsbCh0aGlzLCB7XG4gICAgcG9zLFxuICAgIHZlbDogVXRpbC5yYW5kb21WZWMoTWF0aC5yYW5kb20oKSAqIDYgKyAxKSxcbiAgICBjb2xvcjogQXN0ZXJvaWQuQ09MT1IsXG4gICAgcmFkaXVzOiBBc3Rlcm9pZC5SQURJVVNcbiAgfSlcbn07XG5cbkFzdGVyb2lkLkNPTE9SID0gXCIjNjY2NjY2XCI7XG5Bc3Rlcm9pZC5SQURJVVMgPSAyMDtcblxuVXRpbC5pbmhlcml0cyhBc3Rlcm9pZCwgTW92aW5nT2JqZWN0KTtcblxubW9kdWxlLmV4cG9ydHMgPSBBc3Rlcm9pZDsiLCJjb25zdCBVdGlsID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5jb25zdCBNb3ZpbmdPYmplY3QgPSByZXF1aXJlKFwiLi9tb3Zpbmdfb2JqZWN0XCIpO1xuY29uc3QgR2FtZSA9IHJlcXVpcmUoJy4vZ2FtZScpO1xuY29uc3QgQnVsbGV0ID0gcmVxdWlyZSgnLi9idWxsZXQnKTtcbmNvbnN0IENvbnN0ID0gcmVxdWlyZSgnLi9jb25zdHMnKVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge3twb3M6IFtudW1iZXIsIG51bWJlcl19fSBwYXJhbTAgb3B0aW9uc1xuICogQHBhcmFtIHtHYW1lfSBnYW1lXG4gKi9cbmNvbnN0IFNoaXAgPSBmdW5jdGlvbiAoe3Bvc30sIGdhbWUpIHtcbiAgTW92aW5nT2JqZWN0LmNhbGwodGhpcywge3BvcywgcmFkaXVzOiBTaGlwLlJBRElVUywgY29sb3I6IFNoaXAuQ09MT1IsIHZlbDogWzAsIDBdfSk7XG4gIHRoaXMuZ2FtZSA9IGdhbWU7XG4gIHRoaXMudXBkYXRlQ29udHJvbCgpO1xufVxuXG5TaGlwLlJBRElVUyA9IDE1O1xuU2hpcC5DT0xPUiA9IFwiIzMxYTVkOVwiO1xuVXRpbC5pbmhlcml0cyhTaGlwLCBNb3ZpbmdPYmplY3QpXG5cblNoaXAucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnZlbCA9IFswLCAwXTtcbn1cblxuU2hpcC5wcm90b3R5cGUudXBkYXRlQ29udHJvbCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmNvbnRyb2xsZXIgPSBjb250cm9sU2NoZW1lKHRoaXMuZ2FtZS5nZXRDb250cm9sTW9kZSgpKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge251bWJlcn0ga2V5U3RhdHVzXG4gKi9cblNoaXAucHJvdG90eXBlLmNvbnRyb2wgPSBmdW5jdGlvbiAoa2V5U3RhdHVzKSB7XG4gIHRoaXMudmVsID0gdGhpcy5jb250cm9sbGVyKGtleVN0YXR1cyk7XG59XG5cblNoaXAucHJvdG90eXBlLmZpcmVCdWxsZXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgY29uc3QgcG9zID0gdGhpcy5wb3M7XG4gIGNvbnN0IHZlbCA9IFV0aWwuZXh0ZW5kVmVjdG9yKHRoaXMudmVsLCAxMCkgfHwgWzAsIDEwXTtcbiAgY29uc3QgYnVsbGV0ID0gbmV3IEJ1bGxldCh7cG9zLCB2ZWx9KTtcblxuICB0aGlzLmdhbWUuYWRkKGJ1bGxldCk7XG5cbn1cblxuLyoqXG4gKiBHZXQgYSBmdW5jdGlvbiB0aGF0IHJldHVybnMgYSBzcGVlZCB2ZWN0b3IgYmFzZSBvbiB1c2VyIGlucHV0LlxuICpcbiAqIEBwYXJhbSB7XCJwb2xhclwifFwiY2FydGVzaWFuXCJ9IG1vZGVcbiAqL1xuZnVuY3Rpb24gY29udHJvbFNjaGVtZShtb2RlKSB7XG4gIGlmIChtb2RlID09PSBcInBvbGFyXCIpIHtcbiAgICBsZXQgdGhldGEgPSAwO1xuICAgIGxldCBzcGVlZCA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge251bWJlcn0ga2V5U3RhdHVzXG4gICAgICogQHJldHVybiB7W251bWJlciwgbnVtYmVyXX1cbiAgICAgKi9cbiAgICByZXR1cm4gKGtleVN0YXR1cykgPT4ge1xuICAgICAgaWYgKGtleVN0YXR1cyAmIENvbnN0LndNYXNrKSBzcGVlZCArPSBDb25zdC5TUEVFRF9JTlRFUlZBTDtcbiAgICAgIGlmIChrZXlTdGF0dXMgJiBDb25zdC5hTWFzaykgdGhldGEgLT0gQ29uc3QuU1BFRURfSU5URVJWQUwgLyAyO1xuICAgICAgaWYgKGtleVN0YXR1cyAmIENvbnN0LnNNYXNrKSBzcGVlZCAtPSBDb25zdC5TUEVFRF9JTlRFUlZBTDtcbiAgICAgIGlmIChrZXlTdGF0dXMgJiBDb25zdC5kTWFzaykgdGhldGEgKz0gQ29uc3QuU1BFRURfSU5URVJWQUwgLyAyO1xuICAgICAgcmV0dXJuIFV0aWwucm90YXRlKFV0aWwuZXh0ZW5kVmVjdG9yKFsxLCAwXSwgc3BlZWQpLCB0aGV0YSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGxldCBkeCA9IDA7XG4gICAgbGV0IGR5ID0gMDtcbiAgICByZXR1cm4gKGtleVN0YXR1cykgPT4ge1xuICAgICAgaWYgKGtleVN0YXR1cyAmIENvbnN0LndNYXNrKSBkeSAtPSBDb25zdC5TUEVFRF9JTlRFUlZBTDtcbiAgICAgIGlmIChrZXlTdGF0dXMgJiBDb25zdC5hTWFzaykgZHggLT0gQ29uc3QuU1BFRURfSU5URVJWQUw7XG4gICAgICBpZiAoa2V5U3RhdHVzICYgQ29uc3Quc01hc2spIGR5ICs9IENvbnN0LlNQRUVEX0lOVEVSVkFMO1xuICAgICAgaWYgKGtleVN0YXR1cyAmIENvbnN0LmRNYXNrKSBkeCArPSBDb25zdC5TUEVFRF9JTlRFUlZBTDtcbiAgICAgIHJldHVybiBbZHgsIGR5XTtcbiAgICB9XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBTaGlwO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==