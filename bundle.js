!function(t){var e={};function s(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)s.d(o,i,function(e){return t[e]}.bind(null,i));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=4)}([function(t,e,s){s(1);function o({pos:t,vel:e,radius:s,color:o}){this.pos=t,this.vel=e,this.radius=s,this.color=o}o.prototype.draw=function(t){const[e,s]=this.pos;t.fillStyle=this.color,t.beginPath(),t.arc(e,s,this.radius,0,2*Math.PI),t.fill()},o.prototype.move=function(t){const[e,s]=this.pos,[o,i]=this.vel;this.pos=t([e+o,s+i])},o.prototype.isWrappable=!0,t.exports=o},function(t,e,s){const o=s(6),i=s(7),n=(s(0),s(3)),a=function(){this.movingObjects=new Set;for(let t=0;t<a.NUM_ASTEROIDS;t++){const t=this.randomPostion(),e=new o({pos:t});this.add(e)}const t=this.randomPostion();this.ship=new i({pos:t},this),this.bullets=new Set,this.keyStatus=0};a.prototype.add=function(t){t instanceof o?this.movingObjects.add(t):t instanceof n&&this.bullets.add(t)},a.prototype.remove=function(t){t instanceof o?this.movingObjects.delete(t):t instanceof n&&this.bullets.delete(t)},a.prototype.randomPostion=function(){return[Math.random()*a.DIM_X,Math.random()*a.DIM_Y]},a.prototype.draw=function(t){t.clearRect(0,0,a.DIM_X,a.DIM_Y),this.allObjects().forEach(e=>e.draw(t))},a.prototype.moveObjects=function(){this.keyStatus&a.wMask&&this.ship.power([0,-.25]),this.keyStatus&a.aMask&&this.ship.power([-.25,0]),this.keyStatus&a.sMask&&this.ship.power([0,.25]),this.keyStatus&a.dMask&&this.ship.power([.25,0]),this.keyStatus&a.spaceMask&&this.ship.fireBullet(),this.allObjects().forEach(t=>{t.isWrappable?t.move(this.wrap):t.move(e=>(this.isOutOfBounds(e)&&this.remove(t),e))})},a.prototype.wrap=function([t,e]){return[(t+a.DIM_X)%a.DIM_X,(e+a.DIM_Y)%a.DIM_Y]},a.prototype.checkCollisions=function(){this.movingObjects.forEach(t=>{this.ship.isCollidedWith(t)&&(this.relocate(this.ship),this.ship.reset())}),this.bullets.forEach(t=>{this.movingObjects.forEach(e=>{t.isCollidedWith(e)&&(this.remove(e),this.remove(t))})})},a.prototype.step=function(){this.moveObjects(),this.checkCollisions()},a.prototype.relocate=function(t){t.pos=this.randomPostion()},a.prototype.allObjects=function(){return[...this.movingObjects,this.ship,...this.bullets]},a.prototype.isOutOfBounds=function(t){const[e,s]=t;return e>a.DIM_X||e<0||s>a.DIM_Y||s<0},a.DIM_X=768,a.DIM_Y=512,a.NUM_ASTEROIDS=10,a.wMask=1,a.aMask=16,a.sMask=256,a.dMask=4096,a.spaceMask=65536,t.exports=a},function(t,e){const s={inherits(t,e){const s=function(){};s.prototype=e.prototype,t.prototype=new s,t.prototype.constructor=t},randomVec(t){const e=2*Math.PI*Math.random();return s.scale([Math.sin(e),Math.cos(e)],t)},scale:(t,e)=>[t[0]*e,t[1]*e]};t.exports=s},function(t,e,s){const o=s(0),i=s(2),n=function({pos:t,vel:e}){o.call(this,{pos:t,vel:e,radius:n.RADIUS,color:n.COLOR}),this.isWrappable=!1};n.RADIUS=2,n.COLOR="white",i.inherits(n,o),n.prototype.isCollidedWith=function(t){const[e,s]=this.pos,[o,i]=t.pos;return Math.sqrt((e-o)**2+(s-i)**2)<this.radius+t.radius},t.exports=n},function(t,e,s){"use strict";s.r(e);s(8);const o=s(5);document.addEventListener("DOMContentLoaded",(function(){(new o).start()}))},function(t,e,s){const o=s(1),i=function(){const t=document.getElementById("app-container");this.game=new o;const e=document.createElement("canvas"),s=e.getContext("2d"),i=window.devicePixelRatio;e.width=o.DIM_X*i,e.height=o.DIM_Y*i,e.id="main-canvas",s.scale(i,i),e.tabIndex=1,e.autofocus=!0,t.appendChild(e),this.context=s,this.canvas=e;(function(){e.addEventListener("keydown",t=>{switch(t.key){case"w":this.keyStatus|=o.wMask;break;case"a":this.keyStatus|=o.aMask;break;case"s":this.keyStatus|=o.sMask;break;case"d":this.keyStatus|=o.dMask;break;case" ":this.keyStatus|=o.spaceMask}}),e.addEventListener("keyup",t=>{switch(t.key){case"w":this.keyStatus&=~o.wMask;break;case"a":this.keyStatus&=~o.aMask;break;case"s":this.keyStatus&=~o.sMask;break;case"d":this.keyStatus&=~o.dMask;break;case" ":this.keyStatus&=~o.spaceMask}})}).bind(this.game)()};i.prototype.start=function(){const t=()=>{this.game.step(),this.game.draw(this.context),requestAnimationFrame(t)};t()},i.prototype.bindKeyHandlers=function(){key("W",()=>{this.game.ship.power([0,-1])}),key("S",()=>{this.game.ship.power([0,1])}),key("A",()=>{this.game.ship.power([-1,0])}),key("D",()=>{this.game.ship.power([1,0])}),key("space",()=>{this.game.ship.fireBullet()})},t.exports=i},function(t,e,s){const o=s(2),i=s(0),n=function({pos:t}){i.call(this,{pos:t,vel:o.randomVec(6*Math.random()+1),color:n.COLOR,radius:n.RADIUS})};n.COLOR="#666666",n.RADIUS=20,o.inherits(n,i),t.exports=n},function(t,e,s){const o=s(2),i=s(0),n=(s(1),s(3)),a=function({pos:t},e){i.call(this,{pos:t,radius:a.RADIUS,color:a.COLOR,vel:[0,0]}),this.game=e};a.RADIUS=15,a.COLOR="#31a5d9",o.inherits(a,i),a.prototype.reset=function(){this.vel=[0,0]},a.prototype.isCollidedWith=function(t){const[e,s]=this.pos,[o,i]=t.pos;return Math.sqrt((e-o)**2+(s-i)**2)<this.radius+t.radius},a.prototype.power=function(t){const[e,s]=this.vel,[o,i]=t;this.vel=[e+o,s+i]},a.prototype.fireBullet=function(){const t=this.pos,[e,s]=this.vel;if(0===e&&0===s)return;const o=new n({pos:t,vel:[5*e,5*s]});this.game.add(o)},t.exports=a},function(t,e,s){}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vdmluZ19vYmplY3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzLmpzIiwid2VicGFjazovLy8uL3NyYy9idWxsZXQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9nYW1lX3ZpZXcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FzdGVyb2lkLmpzIiwid2VicGFjazovLy8uL3NyYy9zaGlwLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiTW92aW5nT2JqZWN0IiwicG9zIiwidmVsIiwicmFkaXVzIiwiY29sb3IiLCJ0aGlzIiwiZHJhdyIsImNvbnRleHQiLCJ4IiwieSIsImZpbGxTdHlsZSIsImJlZ2luUGF0aCIsImFyYyIsIk1hdGgiLCJQSSIsImZpbGwiLCJtb3ZlIiwicG9zQ2FsbEJhY2siLCJkeCIsImR5IiwiaXNXcmFwcGFibGUiLCJBc3Rlcm9pZCIsIlNoaXAiLCJCdWxsZXQiLCJHYW1lIiwibW92aW5nT2JqZWN0cyIsIlNldCIsIk5VTV9BU1RFUk9JRFMiLCJyYW5kb21Qb3N0aW9uIiwiYXN0ZXJvaWQiLCJhZGQiLCJzaGlwIiwiYnVsbGV0cyIsImtleVN0YXR1cyIsInJlbW92ZSIsImRlbGV0ZSIsInJhbmRvbSIsIkRJTV9YIiwiRElNX1kiLCJjbGVhclJlY3QiLCJhbGxPYmplY3RzIiwiZm9yRWFjaCIsIm1vdmVPYmplY3RzIiwid01hc2siLCJwb3dlciIsImFNYXNrIiwic01hc2siLCJkTWFzayIsInNwYWNlTWFzayIsImZpcmVCdWxsZXQiLCJ3cmFwIiwiaXNPdXRPZkJvdW5kcyIsImNoZWNrQ29sbGlzaW9ucyIsImlzQ29sbGlkZWRXaXRoIiwicmVsb2NhdGUiLCJyZXNldCIsImIiLCJzdGVwIiwiVXRpbCIsIkNoaWxkQ2xhc3MiLCJQYXJlbnRDbGFzcyIsIlN1cnJvZ2F0ZSIsImNvbnN0cnVjdG9yIiwibGVuZ3RoIiwiZGVnIiwic2NhbGUiLCJzaW4iLCJjb3MiLCJ2ZWMiLCJSQURJVVMiLCJDT0xPUiIsImluaGVyaXRzIiwib3RoZXJPYmplY3QiLCJ4MSIsInkxIiwieDIiLCJ5MiIsInNxcnQiLCJHYW1lVmlldyIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0YXJ0IiwiYXBwQ29udGFpbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJnYW1lIiwiY2FudmFzIiwiY3JlYXRlRWxlbWVudCIsImdldENvbnRleHQiLCJkcHIiLCJ3aW5kb3ciLCJkZXZpY2VQaXhlbFJhdGlvIiwid2lkdGgiLCJoZWlnaHQiLCJpZCIsInRhYkluZGV4IiwiYXV0b2ZvY3VzIiwiYXBwZW5kQ2hpbGQiLCJldmVudCIsImtleWJpbmRpbmdzIiwicmVmcmVzaCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImJpbmRLZXlIYW5kbGVycyIsInJhbmRvbVZlYyIsImltcHVsc2UiLCJpeCIsIml5IiwiYnVsbGV0Il0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxD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QUNyQixHQUFNbUYsR0FDekJwRixFQUFhN0IsS0FBS2tDLEtBQU0sQ0FBQ0osTUFBS0UsT0FBUW1CLEVBQUsrQyxPQUFRakUsTUFBT2tCLEVBQUtnRCxNQUFPcEUsSUFBSyxDQUFDLEVBQUUsS0FDOUVHLEtBQUsrRSxLQUFPQSxHQUdoQjlELEVBQUsrQyxPQUFTLEdBQ2QvQyxFQUFLZ0QsTUFBUSxVQUNiWixFQUFLYSxTQUFTakQsRUFBTXRCLEdBRXBCc0IsRUFBSzFCLFVBQVUyRCxNQUFRLFdBQ3JCbEQsS0FBS0gsSUFBTSxDQUFDLEVBQUcsSUFPakJvQixFQUFLMUIsVUFBVXlELGVBQWlCLFNBQVNtQixHQUV2QyxNQUFPQyxFQUFJQyxHQUFNckUsS0FBS0osS0FDZjBFLEVBQUlDLEdBQU1KLEVBQVl2RSxJQUM3QixPQUFPWSxLQUFLZ0UsTUFBTUosRUFBS0UsSUFBTyxHQUFLRCxFQUFLRSxJQUFPLEdBQUt2RSxLQUFLRixPQUFTcUUsRUFBWXJFLFFBR2hGbUIsRUFBSzFCLFVBQVVnRCxNQUFRLFNBQVMyRCxHQUM5QixNQUFPckYsRUFBSUMsR0FBTWQsS0FBS0gsS0FDZnNHLEVBQUlDLEdBQU1GLEVBQ2pCbEcsS0FBS0gsSUFBTSxDQUFDZ0IsRUFBS3NGLEVBQUlyRixFQUFLc0YsSUFHNUJuRixFQUFLMUIsVUFBVXFELFdBQWEsV0FFMUIsTUFBTWhELEVBQU1JLEtBQUtKLEtBQ1ZpQixFQUFJQyxHQUFNZCxLQUFLSCxJQUN0QixHQUFXLElBQVBnQixHQUFtQixJQUFQQyxFQUFVLE9BQzFCLE1BQ011RixFQUFTLElBQUluRixFQUFPLENBQUN0QixNQUFLQyxJQURwQixDQUFNLEVBQUxnQixFQUFhLEVBQUxDLEtBR3JCZCxLQUFLK0UsS0FBS3RELElBQUk0RSxJQUloQjNJLEVBQU9ELFFBQVV3RCxHIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA0KTtcbiIsImNvbnN0IEdhbWUgPSByZXF1aXJlKCcuL2dhbWUnKTtcblxuLyoqXG4gKiBcbiAqIEBwYXJhbSB7e3BvczogW251bWJlciwgbnVtYmVyXSwgdmVsOiBbbnVtYmVyLCBudW1iZXJdLCByYWRpdXM6IG51bWJlciwgY29sb3I6IHN0cmluZ319IHBhcmFtMCBvcHRpb24gb2JqZWN0XG4gKiBAcGFyYW0ge0dhbWV9IGdhbWVcbiAqL1xuZnVuY3Rpb24gTW92aW5nT2JqZWN0KHtwb3MsIHZlbCwgcmFkaXVzLCBjb2xvcn0pIHtcbiAgdGhpcy5wb3MgPSBwb3M7XG4gIHRoaXMudmVsID0gdmVsO1xuICB0aGlzLnJhZGl1cyA9IHJhZGl1cztcbiAgdGhpcy5jb2xvciA9IGNvbG9yO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSBjb250ZXh0XG4gKi9cblxuTW92aW5nT2JqZWN0LnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24oY29udGV4dCkge1xuICBjb25zdCBbeCwgeV0gPSB0aGlzLnBvcztcbiAgY29udGV4dC5maWxsU3R5bGUgPSB0aGlzLmNvbG9yO1xuICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICBjb250ZXh0LmFyYyhcbiAgICB4LCB5LCB0aGlzLnJhZGl1cywgMCwgMiAqIE1hdGguUElcbiAgKTtcbiAgY29udGV4dC5maWxsKCk7XG59O1xuXG5Nb3ZpbmdPYmplY3QucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbihwb3NDYWxsQmFjaykge1xuICBjb25zdCBbeCwgeV0gPSB0aGlzLnBvcztcbiAgY29uc3QgW2R4LCBkeV0gPSB0aGlzLnZlbDtcbiAgdGhpcy5wb3MgPSBwb3NDYWxsQmFjayhbeCArIGR4LCB5ICsgZHldKTtcbn07XG5cbk1vdmluZ09iamVjdC5wcm90b3R5cGUuaXNXcmFwcGFibGUgPSB0cnVlO1xuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBNb3ZpbmdPYmplY3Q7IiwiY29uc3QgQXN0ZXJvaWQgPSByZXF1aXJlKFwiLi9hc3Rlcm9pZC5qc1wiKTtcbmNvbnN0IFNoaXAgPSByZXF1aXJlKFwiLi9zaGlwXCIpO1xuY29uc3QgTW92aW5nT2JqZWN0ID0gcmVxdWlyZShcIi4vbW92aW5nX29iamVjdFwiKTtcbmNvbnN0IEJ1bGxldCA9IHJlcXVpcmUoJy4vYnVsbGV0Jyk7XG5cbmNvbnN0IEdhbWUgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMubW92aW5nT2JqZWN0cyA9IG5ldyBTZXQoKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBHYW1lLk5VTV9BU1RFUk9JRFM7IGkrKykge1xuICAgIGNvbnN0IHBvcyA9IHRoaXMucmFuZG9tUG9zdGlvbigpO1xuICAgIGNvbnN0IGFzdGVyb2lkID0gbmV3IEFzdGVyb2lkKHsgcG9zIH0pO1xuICAgIHRoaXMuYWRkKGFzdGVyb2lkKTtcbiAgfVxuICBjb25zdCBwb3MgPSB0aGlzLnJhbmRvbVBvc3Rpb24oKTtcbiAgdGhpcy5zaGlwID0gbmV3IFNoaXAoeyBwb3MgfSwgdGhpcyk7XG4gIHRoaXMuYnVsbGV0cyA9IG5ldyBTZXQoKTtcbiAgdGhpcy5rZXlTdGF0dXMgPSAwO1xufVxuXG5HYW1lLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbiAob2JqZWN0KSB7XG4gIGlmIChvYmplY3QgaW5zdGFuY2VvZiBBc3Rlcm9pZCkge1xuICAgIHRoaXMubW92aW5nT2JqZWN0cy5hZGQob2JqZWN0KTtcbiAgfSBlbHNlIGlmIChvYmplY3QgaW5zdGFuY2VvZiBCdWxsZXQpIHtcbiAgICB0aGlzLmJ1bGxldHMuYWRkKG9iamVjdCk7XG4gIH1cbn1cblxuR2FtZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICBpZiAob2JqZWN0IGluc3RhbmNlb2YgQXN0ZXJvaWQpIHtcbiAgICB0aGlzLm1vdmluZ09iamVjdHMuZGVsZXRlKG9iamVjdCk7XG4gIH0gZWxzZSBpZiAob2JqZWN0IGluc3RhbmNlb2YgQnVsbGV0KSB7XG4gICAgdGhpcy5idWxsZXRzLmRlbGV0ZShvYmplY3QpO1xuICB9XG59XG5cblxuR2FtZS5wcm90b3R5cGUucmFuZG9tUG9zdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIFsoTWF0aC5yYW5kb20oKSAqIEdhbWUuRElNX1gpLCAoTWF0aC5yYW5kb20oKSAqIEdhbWUuRElNX1kpXTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gY29udGV4dFxuICovXG5HYW1lLnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgY29udGV4dC5jbGVhclJlY3QoMCwgMCwgR2FtZS5ESU1fWCwgR2FtZS5ESU1fWSk7XG4gIHRoaXMuYWxsT2JqZWN0cygpLmZvckVhY2gobyA9PiBvLmRyYXcoY29udGV4dCkpO1xufVxuXG5HYW1lLnByb3RvdHlwZS5tb3ZlT2JqZWN0cyA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMua2V5U3RhdHVzICYgR2FtZS53TWFzaykgdGhpcy5zaGlwLnBvd2VyKFswLCAtMC4yNV0pO1xuICBpZiAodGhpcy5rZXlTdGF0dXMgJiBHYW1lLmFNYXNrKSB0aGlzLnNoaXAucG93ZXIoWy0wLjI1LCAwXSk7XG4gIGlmICh0aGlzLmtleVN0YXR1cyAmIEdhbWUuc01hc2spIHRoaXMuc2hpcC5wb3dlcihbMCwgMC4yNV0pO1xuICBpZiAodGhpcy5rZXlTdGF0dXMgJiBHYW1lLmRNYXNrKSB0aGlzLnNoaXAucG93ZXIoWzAuMjUsIDBdKTtcbiAgaWYgKHRoaXMua2V5U3RhdHVzICYgR2FtZS5zcGFjZU1hc2spIHRoaXMuc2hpcC5maXJlQnVsbGV0KCk7XG4gIHRoaXMuYWxsT2JqZWN0cygpLmZvckVhY2gobyA9PiB7XG4gICAgaWYgKG8uaXNXcmFwcGFibGUpIHtcbiAgICAgIG8ubW92ZSh0aGlzLndyYXApO1xuICAgIH0gZWxzZSB7XG4gICAgICBvLm1vdmUocG9zID0+IHtcbiAgICAgICAgaWYgKHRoaXMuaXNPdXRPZkJvdW5kcyhwb3MpKSB0aGlzLnJlbW92ZShvKTtcbiAgICAgICAgcmV0dXJuIHBvcztcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtbbnVtYmVyLCBudW1iZXJdfVxuICogQHJldHVybnMge1tudW1iZXIsIG51bWJlcl19XG4gKi9cbkdhbWUucHJvdG90eXBlLndyYXAgPSBmdW5jdGlvbiAoW3gsIHldKSB7XG4gIHJldHVybiBbKHggKyBHYW1lLkRJTV9YKSAlIEdhbWUuRElNX1gsICh5ICsgR2FtZS5ESU1fWSkgJSBHYW1lLkRJTV9ZXTtcbn1cblxuR2FtZS5wcm90b3R5cGUuY2hlY2tDb2xsaXNpb25zID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLm1vdmluZ09iamVjdHMuZm9yRWFjaChvID0+IHtcbiAgICBpZiAodGhpcy5zaGlwLmlzQ29sbGlkZWRXaXRoKG8pKSB7XG4gICAgICB0aGlzLnJlbG9jYXRlKHRoaXMuc2hpcCk7XG4gICAgICB0aGlzLnNoaXAucmVzZXQoKTtcbiAgICB9XG4gIH0pXG4gIHRoaXMuYnVsbGV0cy5mb3JFYWNoKGIgPT4ge1xuICAgIHRoaXMubW92aW5nT2JqZWN0cy5mb3JFYWNoKG8gPT4ge1xuICAgICAgaWYgKGIuaXNDb2xsaWRlZFdpdGgobykpIHtcbiAgICAgICAgdGhpcy5yZW1vdmUobyk7XG4gICAgICAgIHRoaXMucmVtb3ZlKGIpO1xuICAgICAgfVxuICAgIH0pXG4gIH0pXG59XG5cbkdhbWUucHJvdG90eXBlLnN0ZXAgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMubW92ZU9iamVjdHMoKTtcbiAgdGhpcy5jaGVja0NvbGxpc2lvbnMoKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge01vdmluZ09iamVjdH0gb2JqZWN0XG4gKi9cbkdhbWUucHJvdG90eXBlLnJlbG9jYXRlID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICBvYmplY3QucG9zID0gdGhpcy5yYW5kb21Qb3N0aW9uKCk7XG59XG5cbi8qKlxuICogQHJldHVybnMge0FycmF5PE1vdmluZ09iamVjdD59XG4gKi9cbkdhbWUucHJvdG90eXBlLmFsbE9iamVjdHMgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBbLi4udGhpcy5tb3ZpbmdPYmplY3RzLCB0aGlzLnNoaXAsIC4uLnRoaXMuYnVsbGV0c107XG59XG5cbkdhbWUucHJvdG90eXBlLmlzT3V0T2ZCb3VuZHMgPSBmdW5jdGlvbihwb3MpIHtcbiAgY29uc3QgW3gsIHldID0gcG9zO1xuICByZXR1cm4geCA+IEdhbWUuRElNX1ggfHwgeCA8IDAgfHwgeSA+IEdhbWUuRElNX1kgfHwgeSA8IDA7XG59XG5cbkdhbWUuRElNX1ggPSA3Njg7XG5HYW1lLkRJTV9ZID0gNTEyO1xuR2FtZS5OVU1fQVNURVJPSURTID0gMTA7XG5HYW1lLndNYXNrID0gMHgxO1xuR2FtZS5hTWFzayA9IDB4MTA7XG5HYW1lLnNNYXNrID0gMHgxMDA7XG5HYW1lLmRNYXNrID0gMHgxMDAwO1xuR2FtZS5zcGFjZU1hc2sgPSAweDEwMDAwO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWU7XG4iLCJjb25zdCBVdGlsID0ge1xuICBpbmhlcml0cyhDaGlsZENsYXNzLCBQYXJlbnRDbGFzcykge1xuICAgIGNvbnN0IFN1cnJvZ2F0ZSA9IGZ1bmN0aW9uKCkge307XG4gICAgU3Vycm9nYXRlLnByb3RvdHlwZSA9IFBhcmVudENsYXNzLnByb3RvdHlwZTtcbiAgICBDaGlsZENsYXNzLnByb3RvdHlwZSA9IG5ldyBTdXJyb2dhdGUoKTtcbiAgICBDaGlsZENsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IENoaWxkQ2xhc3M7XG4gIH0sXG4gIHJhbmRvbVZlYyhsZW5ndGgpIHtcbiAgICBjb25zdCBkZWcgPSAyICogTWF0aC5QSSAqIE1hdGgucmFuZG9tKCk7XG4gICAgcmV0dXJuIFV0aWwuc2NhbGUoW01hdGguc2luKGRlZyksIE1hdGguY29zKGRlZyldLCBsZW5ndGgpO1xuICB9LFxuICAvLyBTY2FsZSB0aGUgbGVuZ3RoIG9mIGEgdmVjdG9yIGJ5IHRoZSBnaXZlbiBhbW91bnQuXG4gIHNjYWxlKHZlYywgbSkge1xuICAgIHJldHVybiBbdmVjWzBdICogbSwgdmVjWzFdICogbV07XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVXRpbDsiLCJjb25zdCBNb3ZpbmdPYmplY3QgPSByZXF1aXJlKCcuL21vdmluZ19vYmplY3QnKTtcbmNvbnN0IFV0aWwgPSByZXF1aXJlKCcuL3V0aWxzJylcblxuY29uc3QgQnVsbGV0ID0gZnVuY3Rpb24oe3BvcywgdmVsfSkge1xuICBNb3ZpbmdPYmplY3QuY2FsbCh0aGlzLCB7cG9zLCB2ZWwsIHJhZGl1czogQnVsbGV0LlJBRElVUywgY29sb3I6IEJ1bGxldC5DT0xPUn0pO1xuICB0aGlzLmlzV3JhcHBhYmxlID0gZmFsc2U7XG59XG5cbkJ1bGxldC5SQURJVVMgPSAyO1xuQnVsbGV0LkNPTE9SID0gXCJ3aGl0ZVwiO1xuXG5VdGlsLmluaGVyaXRzKEJ1bGxldCwgTW92aW5nT2JqZWN0KTtcblxuQnVsbGV0LnByb3RvdHlwZS5pc0NvbGxpZGVkV2l0aCA9IGZ1bmN0aW9uKG90aGVyT2JqZWN0KSB7XG4gIGNvbnN0IFt4MSwgeTFdID0gdGhpcy5wb3M7XG4gIGNvbnN0IFt4MiwgeTJdID0gb3RoZXJPYmplY3QucG9zO1xuICByZXR1cm4gTWF0aC5zcXJ0KCh4MSAtIHgyKSAqKiAyICsgKHkxIC0geTIpICoqIDIpIDwgdGhpcy5yYWRpdXMgKyBvdGhlck9iamVjdC5yYWRpdXM7XG59XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IEJ1bGxldDsiLCJjb25zdCBHYW1lVmlldyA9IHJlcXVpcmUoXCIuL2dhbWVfdmlld1wiKTtcbmltcG9ydCAnLi4vY3NzL3N0eWxlLnNjc3MnO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbigpIHtcbiAgICBjb25zdCBnYW1lID0gbmV3IEdhbWVWaWV3KCk7XG4gICAgZ2FtZS5zdGFydCgpO1xufSlcblxuIiwiY29uc3QgR2FtZSA9IHJlcXVpcmUoXCIuL2dhbWVcIik7XG5cbmNvbnN0IEdhbWVWaWV3ID0gZnVuY3Rpb24oKSB7XG5cbiAgY29uc3QgYXBwQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhcHAtY29udGFpbmVyXCIpO1xuXG4gIHRoaXMuZ2FtZSA9IG5ldyBHYW1lKCk7XG5cbiAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcbiAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5cbiAgY29uc3QgZHByID0gd2luZG93LmRldmljZVBpeGVsUmF0aW87XG4gIGNhbnZhcy53aWR0aCA9IEdhbWUuRElNX1ggKiBkcHI7XG4gIGNhbnZhcy5oZWlnaHQgPSBHYW1lLkRJTV9ZICogZHByO1xuICBjYW52YXMuaWQgPSBcIm1haW4tY2FudmFzXCI7XG4gIGNvbnRleHQuc2NhbGUoZHByLCBkcHIpO1xuICBjYW52YXMudGFiSW5kZXggPSAxO1xuICBjYW52YXMuYXV0b2ZvY3VzID0gdHJ1ZTtcbiAgYXBwQ29udGFpbmVyLmFwcGVuZENoaWxkKGNhbnZhcyk7XG5cbiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgdGhpcy5jYW52YXMgPSBjYW52YXM7XG5cbiAgY29uc3Qga2V5YmluZGluZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgc3dpdGNoIChldmVudC5rZXkpIHtcbiAgICAgICAgY2FzZSAndyc6XG4gICAgICAgICAgdGhpcy5rZXlTdGF0dXMgfD0gR2FtZS53TWFzaztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnYSc6XG4gICAgICAgICAgdGhpcy5rZXlTdGF0dXMgfD0gR2FtZS5hTWFzaztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAncyc6XG4gICAgICAgICAgdGhpcy5rZXlTdGF0dXMgfD0gR2FtZS5zTWFzaztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZCc6XG4gICAgICAgICAgdGhpcy5rZXlTdGF0dXMgfD0gR2FtZS5kTWFzaztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnICc6XG4gICAgICAgICAgdGhpcy5rZXlTdGF0dXMgfD0gR2FtZS5zcGFjZU1hc2s7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIHN3aXRjaCAoZXZlbnQua2V5KSB7XG4gICAgICAgIGNhc2UgJ3cnOlxuICAgICAgICAgIHRoaXMua2V5U3RhdHVzICY9IH5HYW1lLndNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdhJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+R2FtZS5hTWFzaztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAncyc6XG4gICAgICAgICAgdGhpcy5rZXlTdGF0dXMgJj0gfkdhbWUuc01hc2s7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2QnOlxuICAgICAgICAgIHRoaXMua2V5U3RhdHVzICY9IH5HYW1lLmRNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICcgJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+R2FtZS5zcGFjZU1hc2s7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSlcbiAgfS5iaW5kKHRoaXMuZ2FtZSk7XG5cbiAga2V5YmluZGluZ3MoKTtcblxufVxuXG5HYW1lVmlldy5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbigpIHtcbiAgLy8gdGhpcy5iaW5kS2V5SGFuZGxlcnMoKTtcbiAgY29uc3QgcmVmcmVzaCA9ICgpID0+IHtcbiAgICB0aGlzLmdhbWUuc3RlcCgpO1xuICAgIHRoaXMuZ2FtZS5kcmF3KHRoaXMuY29udGV4dCk7XG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJlZnJlc2gpO1xuICB9XG4gIHJlZnJlc2goKTtcbn1cblxuR2FtZVZpZXcucHJvdG90eXBlLmJpbmRLZXlIYW5kbGVycyA9IGZ1bmN0aW9uKCkge1xuICBrZXkoJ1cnLCAoKSA9PiB7XG4gICAgdGhpcy5nYW1lLnNoaXAucG93ZXIoWzAsIC0xXSk7XG4gIH0pXG4gIGtleSgnUycsICgpID0+IHtcbiAgICB0aGlzLmdhbWUuc2hpcC5wb3dlcihbMCwgMV0pO1xuICB9KVxuICBrZXkoJ0EnLCAoKSA9PiB7XG4gICAgdGhpcy5nYW1lLnNoaXAucG93ZXIoWy0xLCAwXSk7XG4gIH0pXG4gIGtleSgnRCcsICgpID0+IHtcbiAgICB0aGlzLmdhbWUuc2hpcC5wb3dlcihbMSwgMF0pO1xuICB9KVxuICBrZXkoXCJzcGFjZVwiLCAoKSA9PiB7XG4gICAgICB0aGlzLmdhbWUuc2hpcC5maXJlQnVsbGV0KCk7XG4gIH0pXG59XG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZVZpZXc7XG4iLCJjb25zdCBVdGlsID0gcmVxdWlyZSgnLi91dGlscycpXG5jb25zdCBNb3ZpbmdPYmplY3QgPSByZXF1aXJlKCcuL21vdmluZ19vYmplY3QnKTtcblxuLyoqXG4gKlxuICogQHBhcmFtIHt7cG9zOiBbbnVtYmVyLCBudW1iZXJdfX0gcGFyYW0wIG9wdGlvbnNcbiAqL1xuY29uc3QgQXN0ZXJvaWQgPSBmdW5jdGlvbiAoeyBwb3MgfSkge1xuICBNb3ZpbmdPYmplY3QuY2FsbCh0aGlzLCB7XG4gICAgcG9zLFxuICAgIHZlbDogVXRpbC5yYW5kb21WZWMoTWF0aC5yYW5kb20oKSAqIDYgKyAxKSxcbiAgICBjb2xvcjogQXN0ZXJvaWQuQ09MT1IsXG4gICAgcmFkaXVzOiBBc3Rlcm9pZC5SQURJVVNcbiAgfSlcbn07XG5cbkFzdGVyb2lkLkNPTE9SID0gXCIjNjY2NjY2XCI7XG5Bc3Rlcm9pZC5SQURJVVMgPSAyMDtcblxuVXRpbC5pbmhlcml0cyhBc3Rlcm9pZCwgTW92aW5nT2JqZWN0KTtcblxubW9kdWxlLmV4cG9ydHMgPSBBc3Rlcm9pZDsiLCJjb25zdCBVdGlsID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5jb25zdCBNb3ZpbmdPYmplY3QgPSByZXF1aXJlKFwiLi9tb3Zpbmdfb2JqZWN0XCIpO1xuY29uc3QgR2FtZSA9IHJlcXVpcmUoJy4vZ2FtZScpO1xuY29uc3QgQnVsbGV0ID0gcmVxdWlyZSgnLi9idWxsZXQnKTtcblxuLyoqXG4gKiBcbiAqIEBwYXJhbSB7e3BvczogW251bWJlciwgbnVtYmVyXX19IHBhcmFtMCBvcHRpb25zXG4gKiBAcGFyYW0ge0dhbWV9IGdhbWUgXG4gKi9cbmNvbnN0IFNoaXAgPSBmdW5jdGlvbih7cG9zfSwgZ2FtZSkge1xuICAgIE1vdmluZ09iamVjdC5jYWxsKHRoaXMsIHtwb3MsIHJhZGl1czogU2hpcC5SQURJVVMsIGNvbG9yOiBTaGlwLkNPTE9SLCB2ZWw6IFswLDBdfSk7XG4gICAgdGhpcy5nYW1lID0gZ2FtZTtcbn1cblxuU2hpcC5SQURJVVMgPSAxNTtcblNoaXAuQ09MT1IgPSBcIiMzMWE1ZDlcIjtcblV0aWwuaW5oZXJpdHMoU2hpcCwgTW92aW5nT2JqZWN0KVxuXG5TaGlwLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnZlbCA9IFswLCAwXTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge01vdmluZ09iamVjdH0gb3RoZXJPYmplY3RcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5TaGlwLnByb3RvdHlwZS5pc0NvbGxpZGVkV2l0aCA9IGZ1bmN0aW9uKG90aGVyT2JqZWN0KSB7XG5cbiAgY29uc3QgW3gxLCB5MV0gPSB0aGlzLnBvcztcbiAgY29uc3QgW3gyLCB5Ml0gPSBvdGhlck9iamVjdC5wb3M7XG4gIHJldHVybiBNYXRoLnNxcnQoKHgxIC0geDIpICoqIDIgKyAoeTEgLSB5MikgKiogMikgPCB0aGlzLnJhZGl1cyArIG90aGVyT2JqZWN0LnJhZGl1cztcbn07XG5cblNoaXAucHJvdG90eXBlLnBvd2VyID0gZnVuY3Rpb24oaW1wdWxzZSkge1xuICBjb25zdCBbZHgsIGR5XSA9IHRoaXMudmVsO1xuICBjb25zdCBbaXgsIGl5XSA9IGltcHVsc2U7XG4gIHRoaXMudmVsID0gW2R4ICsgaXgsIGR5ICsgaXldO1xufVxuXG5TaGlwLnByb3RvdHlwZS5maXJlQnVsbGV0ID0gZnVuY3Rpb24oKSB7XG5cbiAgY29uc3QgcG9zID0gdGhpcy5wb3M7XG4gIGNvbnN0IFtkeCwgZHldID0gdGhpcy52ZWw7XG4gIGlmIChkeCA9PT0gMCAmJiBkeSA9PT0gMCkgcmV0dXJuO1xuICBjb25zdCB2ZWwgPSBbZHggKiA1LCBkeSAqIDVdO1xuICBjb25zdCBidWxsZXQgPSBuZXcgQnVsbGV0KHtwb3MsIHZlbH0pO1xuICBcbiAgdGhpcy5nYW1lLmFkZChidWxsZXQpO1xuICBcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBTaGlwOyJdLCJzb3VyY2VSb290IjoiIn0=