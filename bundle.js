!function(t){var e={};function o(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=e,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(s,n,function(e){return t[e]}.bind(null,n));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=5)}([function(t,e,o){o(1);function s({pos:t,vel:e,radius:o,color:s}){this.pos=t,this.vel=e,this.radius=o,this.color=s}s.prototype.draw=function(t){const[e,o]=this.pos;t.fillStyle=this.color,t.beginPath(),t.arc(e,o,this.radius,0,2*Math.PI),t.fill()},s.prototype.move=function(t){const[e,o]=this.pos,[s,n]=this.vel;this.pos=t([e+s,o+n])},s.prototype.isWrappable=!0,t.exports=s},function(t,e,o){const s=o(7),n=o(8),i=(o(0),o(4)),r=o(3),a=function(){this.controlMode="polar",this.movingObjects=new Set;for(let t=0;t<a.NUM_ASTEROIDS;t++){const t=this.randomPosition(),e=new s({pos:t});this.add(e)}const t=this.randomPosition();this.ship=new n({pos:t},this),this.bullets=new Set,this.keyStatus=0};a.prototype.add=function(t){t instanceof s?this.movingObjects.add(t):t instanceof i&&this.bullets.add(t)},a.prototype.remove=function(t){t instanceof s?this.movingObjects.delete(t):t instanceof i&&this.bullets.delete(t)},a.prototype.getControlMode=function(){return this.controlMode},a.prototype.setControlMode=function(t){this.controlMode=t,this.ship.updateControl()},a.prototype.randomPosition=function(){return[Math.random()*r.DIM_X,Math.random()*r.DIM_Y]},a.prototype.draw=function(t){t.clearRect(0,0,r.DIM_X,r.DIM_Y),this.allObjects().forEach(e=>e.draw(t))},a.prototype.moveObjects=function(){this.ship.control(this.keyStatus),this.keyStatus&r.spaceMask&&this.ship.fireBullet(),this.allObjects().forEach(t=>{t.isWrappable?t.move(this.wrap):t.move(e=>(this.isOutOfBounds(e)&&this.remove(t),e))})},a.prototype.wrap=function([t,e]){return[(t+r.DIM_X)%r.DIM_X,(e+r.DIM_Y)%r.DIM_Y]},a.prototype.checkCollisions=function(){this.movingObjects.forEach(t=>{this.ship.isCollidedWith(t)&&(this.relocate(this.ship),this.ship.reset())}),this.bullets.forEach(t=>{this.movingObjects.forEach(e=>{t.isCollidedWith(e)&&(this.remove(e),this.remove(t))})})},a.prototype.step=function(){this.moveObjects(),this.checkCollisions()},a.prototype.relocate=function(t){t.pos=this.randomPosition()},a.prototype.allObjects=function(){return[...this.movingObjects,this.ship,...this.bullets]},a.prototype.isOutOfBounds=function(t){const[e,o]=t;return e>a.DIM_X||e<0||o>a.DIM_Y||o<0},a.NUM_ASTEROIDS=20,t.exports=a},function(t,e){const o={inherits(t,e){const o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t},randomVec(t){const e=2*Math.PI*Math.random();return o.scale([Math.sin(e),Math.cos(e)],t)},scale:(t,e)=>[t[0]*e,t[1]*e],magnitudeSqOf(t){const[e,o]=t;return e**2+o**2},magnitudeOf(t){return Math.sqrt(this.magnitudeSqOf(t))},unitVectorOf(t){const e=this.magnitudeOf(t);return e?this.scale(t,1/e):t},extendVector(t,e){const o=this.magnitudeOf(t);if(o){const s=o+e;return this.scale(this.scale(t,1/o),s)}return null},rotate(t,e){const[o,s]=t;return[o*Math.cos(e)-s*Math.sin(e),o*Math.sin(e)+s*Math.cos(e)]}};t.exports=o},function(t,e){t.exports={DIM_X:768,DIM_Y:512,wMask:1,aMask:2,sMask:4,dMask:8,spaceMask:16,SPEED_INTERVAL:.25}},function(t,e,o){const s=o(0),n=o(2),i=function({pos:t,vel:e}){s.call(this,{pos:t,vel:e,radius:i.RADIUS,color:i.COLOR}),this.isWrappable=!1};i.RADIUS=2,i.COLOR="white",n.inherits(i,s),i.prototype.isCollidedWith=function(t){const[e,o]=this.pos,[s,n]=t.pos;return Math.sqrt((e-s)**2+(o-n)**2)<this.radius+t.radius},t.exports=i},function(t,e,o){"use strict";o.r(e);o(9);const s=o(6);document.addEventListener("DOMContentLoaded",(function(){(new s).start()}))},function(t,e,o){const s=o(1),n=o(3),i=function(){const t=document.getElementById("app-container");this.game=new s;const e=document.createElement("canvas"),o=e.getContext("2d"),i=window.devicePixelRatio;e.width=n.DIM_X*i,e.height=n.DIM_Y*i,e.id="main-canvas",o.scale(i,i),e.tabIndex=1,e.autofocus=!0,t.appendChild(e);const r=function(){a.innerText=`Switch to ${this.getControlMode()} mode`,this.setControlMode("polar"===this.getControlMode()?"cartesian":"polar")}.bind(this.game),a=document.createElement("button");a.onclick=r,a.innerText=`Switch to ${"polar"===this.game.getControlMode()?"cartesian":"polar"} mode`,t.appendChild(a),this.context=o,this.canvas=e;(function(){e.addEventListener("keydown",t=>{switch(t.key){case"w":this.keyStatus|=n.wMask;break;case"a":this.keyStatus|=n.aMask;break;case"s":this.keyStatus|=n.sMask;break;case"d":this.keyStatus|=n.dMask;break;case" ":this.keyStatus|=n.spaceMask}}),e.addEventListener("keyup",t=>{switch(t.key){case"w":this.keyStatus&=~n.wMask;break;case"a":this.keyStatus&=~n.aMask;break;case"s":this.keyStatus&=~n.sMask;break;case"d":this.keyStatus&=~n.dMask;break;case" ":this.keyStatus&=~n.spaceMask;break;case"Escape":r()}})}).bind(this.game)()};i.prototype.start=function(){const t=()=>{this.game.step(),this.game.draw(this.context),requestAnimationFrame(t)};t()},i.prototype.bindKeyHandlers=function(){key("W",()=>{this.game.ship.power([0,-1])}),key("S",()=>{this.game.ship.power([0,1])}),key("A",()=>{this.game.ship.power([-1,0])}),key("D",()=>{this.game.ship.power([1,0])}),key("space",()=>{this.game.ship.fireBullet()})},t.exports=i},function(t,e,o){const s=o(2),n=o(0),i=function({pos:t}){n.call(this,{pos:t,vel:s.randomVec(6*Math.random()+1),color:i.COLOR,radius:i.RADIUS})};i.COLOR="#666666",i.RADIUS=20,s.inherits(i,n),t.exports=i},function(t,e,o){const s=o(2),n=o(0),i=(o(1),o(4)),r=o(3),a=function({pos:t},e){n.call(this,{pos:t,radius:a.RADIUS,color:a.COLOR,vel:[0,0]}),this.game=e,this.updateControl()};a.RADIUS=15,a.COLOR="#31a5d9",s.inherits(a,n),a.prototype.reset=function(){this.vel=[0,0]},a.prototype.isCollidedWith=function(t){const[e,o]=this.pos,[s,n]=t.pos;return Math.sqrt((e-s)**2+(o-n)**2)<this.radius+t.radius},a.prototype.updateControl=function(){this.controller=function(t){if("polar"===t){let t=0,e=0;return o=>(o&r.wMask&&(e+=r.SPEED_INTERVAL),o&r.aMask&&(t-=r.SPEED_INTERVAL/2),o&r.sMask&&(e-=r.SPEED_INTERVAL),o&r.dMask&&(t+=r.SPEED_INTERVAL/2),s.rotate(s.extendVector([1,0],e),t))}{let t=0,e=0;return o=>(o&r.wMask&&(e-=r.SPEED_INTERVAL),o&r.aMask&&(t-=r.SPEED_INTERVAL),o&r.sMask&&(e+=r.SPEED_INTERVAL),o&r.dMask&&(t+=r.SPEED_INTERVAL),[t,e])}}(this.game.getControlMode())},a.prototype.control=function(t){this.vel=this.controller(t)},a.prototype.fireBullet=function(){const t=this.pos,e=s.extendVector(this.vel,10)||[0,10],o=new i({pos:t,vel:e});this.game.add(o)},t.exports=a},function(t,e,o){}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL21vdmluZ19vYmplY3QuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWxzLmpzIiwid2VicGFjazovLy8uL3NyYy9jb25zdHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2J1bGxldC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWVfdmlldy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvYXN0ZXJvaWQuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NoaXAuanMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJNb3ZpbmdPYmplY3QiLCJwb3MiLCJ2ZWwiLCJyYWRpdXMiLCJjb2xvciIsInRoaXMiLCJkcmF3IiwiY29udGV4dCIsIngiLCJ5IiwiZmlsbFN0eWxlIiwiYmVnaW5QYXRoIiwiYXJjIiwiTWF0aCIsIlBJIiwiZmlsbCIsIm1vdmUiLCJwb3NDYWxsQmFjayIsImR4IiwiZHkiLCJpc1dyYXBwYWJsZSIsIkFzdGVyb2lkIiwiU2hpcCIsIkJ1bGxldCIsIkNvbnN0cyIsIkdhbWUiLCJjb250cm9sTW9kZSIsIm1vdmluZ09iamVjdHMiLCJTZXQiLCJOVU1fQVNURVJPSURTIiwicmFuZG9tUG9zaXRpb24iLCJhc3Rlcm9pZCIsImFkZCIsInNoaXAiLCJidWxsZXRzIiwia2V5U3RhdHVzIiwicmVtb3ZlIiwiZGVsZXRlIiwiZ2V0Q29udHJvbE1vZGUiLCJzZXRDb250cm9sTW9kZSIsInVwZGF0ZUNvbnRyb2wiLCJyYW5kb20iLCJESU1fWCIsIkRJTV9ZIiwiY2xlYXJSZWN0IiwiYWxsT2JqZWN0cyIsImZvckVhY2giLCJtb3ZlT2JqZWN0cyIsImNvbnRyb2wiLCJzcGFjZU1hc2siLCJmaXJlQnVsbGV0Iiwid3JhcCIsImlzT3V0T2ZCb3VuZHMiLCJjaGVja0NvbGxpc2lvbnMiLCJpc0NvbGxpZGVkV2l0aCIsInJlbG9jYXRlIiwicmVzZXQiLCJiIiwic3RlcCIsIlV0aWwiLCJDaGlsZENsYXNzIiwiUGFyZW50Q2xhc3MiLCJTdXJyb2dhdGUiLCJjb25zdHJ1Y3RvciIsImxlbmd0aCIsImRlZyIsInNjYWxlIiwic2luIiwiY29zIiwidmVjIiwidmVjdG9yIiwic3FydCIsIm1hZ25pdHVkZVNxT2YiLCJtYWduaXR1ZGUiLCJtYWduaXR1ZGVPZiIsImV4dGVuZGVkTWFnbml0dWRlIiwidGhldGEiLCJ3TWFzayIsImFNYXNrIiwic01hc2siLCJkTWFzayIsIlNQRUVEX0lOVEVSVkFMIiwiUkFESVVTIiwiQ09MT1IiLCJpbmhlcml0cyIsIm90aGVyT2JqZWN0IiwieDEiLCJ5MSIsIngyIiwieTIiLCJHYW1lVmlldyIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0YXJ0IiwiYXBwQ29udGFpbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJnYW1lIiwiY2FudmFzIiwiY3JlYXRlRWxlbWVudCIsImdldENvbnRleHQiLCJkcHIiLCJ3aW5kb3ciLCJkZXZpY2VQaXhlbFJhdGlvIiwid2lkdGgiLCJoZWlnaHQiLCJpZCIsInRhYkluZGV4IiwiYXV0b2ZvY3VzIiwiYXBwZW5kQ2hpbGQiLCJzd2l0Y2hNb2RlQWN0aW9uIiwic3dpdGNoTW9kZUJ1dHRvbiIsImlubmVyVGV4dCIsIm9uY2xpY2siLCJldmVudCIsImtleWJpbmRpbmdzIiwicmVmcmVzaCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImJpbmRLZXlIYW5kbGVycyIsInBvd2VyIiwicmFuZG9tVmVjIiwiQ29uc3QiLCJjb250cm9sbGVyIiwic3BlZWQiLCJyb3RhdGUiLCJleHRlbmRWZWN0b3IiLCJjb250cm9sU2NoZW1lIiwiYnVsbGV0Il0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BCLEdBQVcsRUFBUEUsR0FBOEIsaUJBQVZGLEdBQXNCQSxHQUFTQSxFQUFNRyxXQUFZLE9BQU9ILEVBQ2hGLElB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QUN4QzlDLEVBQVlxRixFQUFNeEMsUUFBT0osR0FBUzRDLEVBQU12QyxlQUFpQixHQUN0RHRCLEVBQUtnRSxPQUFPaEUsRUFBS2lFLGFBQWEsQ0FBQyxFQUFHLEdBQUlGLEdBQVE5QyxJQUVsRCxDQUNMLElBQUkxRCxFQUFLLEVBQ0xDLEVBQUssRUFDVCxPQUFRZ0IsSUFDRkEsRUFBWXFGLEVBQU0zQyxRQUFPMUQsR0FBTXFHLEVBQU12QyxnQkFDckM5QyxFQUFZcUYsRUFBTTFDLFFBQU81RCxHQUFNc0csRUFBTXZDLGdCQUNyQzlDLEVBQVlxRixFQUFNekMsUUFBTzVELEdBQU1xRyxFQUFNdkMsZ0JBQ3JDOUMsRUFBWXFGLEVBQU14QyxRQUFPOUQsR0FBTXNHLEVBQU12QyxnQkFDbEMsQ0FBQy9ELEVBQUlDLEtBakRFMEcsQ0FBY3hILEtBQUsyRixLQUFLMUQsbUJBTTVDaEIsRUFBSzFCLFVBQVVvRCxRQUFVLFNBQVViLEdBQ2pDOUIsS0FBS0gsSUFBTUcsS0FBS29ILFdBQVd0RixJQUc3QmIsRUFBSzFCLFVBQVVzRCxXQUFhLFdBRTFCLE1BQU1qRCxFQUFNSSxLQUFLSixJQUNYQyxFQUFNeUQsRUFBS2lFLGFBQWF2SCxLQUFLSCxJQUFLLEtBQU8sQ0FBQyxFQUFHLElBQzdDNEgsRUFBUyxJQUFJdkcsRUFBTyxDQUFDdEIsTUFBS0MsUUFFaENHLEtBQUsyRixLQUFLaEUsSUFBSThGLElBc0NoQi9KLEVBQU9ELFFBQVV3RCxHIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA1KTtcbiIsImNvbnN0IEdhbWUgPSByZXF1aXJlKCcuL2dhbWUnKTtcblxuLyoqXG4gKiBcbiAqIEBwYXJhbSB7e3BvczogW251bWJlciwgbnVtYmVyXSwgdmVsOiBbbnVtYmVyLCBudW1iZXJdLCByYWRpdXM6IG51bWJlciwgY29sb3I6IHN0cmluZ319IHBhcmFtMCBvcHRpb24gb2JqZWN0XG4gKiBAcGFyYW0ge0dhbWV9IGdhbWVcbiAqL1xuZnVuY3Rpb24gTW92aW5nT2JqZWN0KHtwb3MsIHZlbCwgcmFkaXVzLCBjb2xvcn0pIHtcbiAgdGhpcy5wb3MgPSBwb3M7XG4gIHRoaXMudmVsID0gdmVsO1xuICB0aGlzLnJhZGl1cyA9IHJhZGl1cztcbiAgdGhpcy5jb2xvciA9IGNvbG9yO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSBjb250ZXh0XG4gKi9cblxuTW92aW5nT2JqZWN0LnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24oY29udGV4dCkge1xuICBjb25zdCBbeCwgeV0gPSB0aGlzLnBvcztcbiAgY29udGV4dC5maWxsU3R5bGUgPSB0aGlzLmNvbG9yO1xuICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICBjb250ZXh0LmFyYyhcbiAgICB4LCB5LCB0aGlzLnJhZGl1cywgMCwgMiAqIE1hdGguUElcbiAgKTtcbiAgY29udGV4dC5maWxsKCk7XG59O1xuXG5Nb3ZpbmdPYmplY3QucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbihwb3NDYWxsQmFjaykge1xuICBjb25zdCBbeCwgeV0gPSB0aGlzLnBvcztcbiAgY29uc3QgW2R4LCBkeV0gPSB0aGlzLnZlbDtcbiAgdGhpcy5wb3MgPSBwb3NDYWxsQmFjayhbeCArIGR4LCB5ICsgZHldKTtcbn07XG5cbk1vdmluZ09iamVjdC5wcm90b3R5cGUuaXNXcmFwcGFibGUgPSB0cnVlO1xuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBNb3ZpbmdPYmplY3Q7IiwiY29uc3QgQXN0ZXJvaWQgPSByZXF1aXJlKFwiLi9hc3Rlcm9pZC5qc1wiKTtcbmNvbnN0IFNoaXAgPSByZXF1aXJlKFwiLi9zaGlwXCIpO1xuY29uc3QgTW92aW5nT2JqZWN0ID0gcmVxdWlyZShcIi4vbW92aW5nX29iamVjdFwiKTtcbmNvbnN0IEJ1bGxldCA9IHJlcXVpcmUoJy4vYnVsbGV0Jyk7XG5jb25zdCBDb25zdHMgPSByZXF1aXJlKCcuL2NvbnN0cycpO1xuXG5jb25zdCBHYW1lID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLmNvbnRyb2xNb2RlID0gJ3BvbGFyJztcbiAgdGhpcy5tb3ZpbmdPYmplY3RzID0gbmV3IFNldCgpO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IEdhbWUuTlVNX0FTVEVST0lEUzsgaSsrKSB7XG4gICAgY29uc3QgcG9zID0gdGhpcy5yYW5kb21Qb3NpdGlvbigpO1xuICAgIGNvbnN0IGFzdGVyb2lkID0gbmV3IEFzdGVyb2lkKHsgcG9zIH0pO1xuICAgIHRoaXMuYWRkKGFzdGVyb2lkKTtcbiAgfVxuICBjb25zdCBwb3MgPSB0aGlzLnJhbmRvbVBvc2l0aW9uKCk7XG4gIHRoaXMuc2hpcCA9IG5ldyBTaGlwKHsgcG9zIH0sIHRoaXMpO1xuICB0aGlzLmJ1bGxldHMgPSBuZXcgU2V0KCk7XG4gIHRoaXMua2V5U3RhdHVzID0gMDtcbn1cblxuR2FtZS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKG9iamVjdCkge1xuICBpZiAob2JqZWN0IGluc3RhbmNlb2YgQXN0ZXJvaWQpIHtcbiAgICB0aGlzLm1vdmluZ09iamVjdHMuYWRkKG9iamVjdCk7XG4gIH0gZWxzZSBpZiAob2JqZWN0IGluc3RhbmNlb2YgQnVsbGV0KSB7XG4gICAgdGhpcy5idWxsZXRzLmFkZChvYmplY3QpO1xuICB9XG59XG5cbkdhbWUucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgaWYgKG9iamVjdCBpbnN0YW5jZW9mIEFzdGVyb2lkKSB7XG4gICAgdGhpcy5tb3ZpbmdPYmplY3RzLmRlbGV0ZShvYmplY3QpO1xuICB9IGVsc2UgaWYgKG9iamVjdCBpbnN0YW5jZW9mIEJ1bGxldCkge1xuICAgIHRoaXMuYnVsbGV0cy5kZWxldGUob2JqZWN0KTtcbiAgfVxufVxuXG5HYW1lLnByb3RvdHlwZS5nZXRDb250cm9sTW9kZSA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gdGhpcy5jb250cm9sTW9kZTtcbn1cblxuR2FtZS5wcm90b3R5cGUuc2V0Q29udHJvbE1vZGUgPSBmdW5jdGlvbihtb2RlKSB7XG4gIHRoaXMuY29udHJvbE1vZGUgPSBtb2RlO1xuICB0aGlzLnNoaXAudXBkYXRlQ29udHJvbCgpO1xufVxuXG5HYW1lLnByb3RvdHlwZS5yYW5kb21Qb3NpdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIFsoTWF0aC5yYW5kb20oKSAqIENvbnN0cy5ESU1fWCksIChNYXRoLnJhbmRvbSgpICogQ29uc3RzLkRJTV9ZKV07XG59XG5cbi8qKlxuICogQHBhcmFtIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9IGNvbnRleHRcbiAqL1xuR2FtZS5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIENvbnN0cy5ESU1fWCwgQ29uc3RzLkRJTV9ZKTtcbiAgdGhpcy5hbGxPYmplY3RzKCkuZm9yRWFjaChvID0+IG8uZHJhdyhjb250ZXh0KSk7XG59XG5cbkdhbWUucHJvdG90eXBlLm1vdmVPYmplY3RzID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnNoaXAuY29udHJvbCh0aGlzLmtleVN0YXR1cyk7XG4gIGlmICh0aGlzLmtleVN0YXR1cyAmIENvbnN0cy5zcGFjZU1hc2spIHRoaXMuc2hpcC5maXJlQnVsbGV0KCk7XG4gIHRoaXMuYWxsT2JqZWN0cygpLmZvckVhY2gobyA9PiB7XG4gICAgaWYgKG8uaXNXcmFwcGFibGUpIHtcbiAgICAgIG8ubW92ZSh0aGlzLndyYXApO1xuICAgIH0gZWxzZSB7XG4gICAgICBvLm1vdmUocG9zID0+IHtcbiAgICAgICAgaWYgKHRoaXMuaXNPdXRPZkJvdW5kcyhwb3MpKSB0aGlzLnJlbW92ZShvKTtcbiAgICAgICAgcmV0dXJuIHBvcztcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtbbnVtYmVyLCBudW1iZXJdfVxuICogQHJldHVybnMge1tudW1iZXIsIG51bWJlcl19XG4gKi9cbkdhbWUucHJvdG90eXBlLndyYXAgPSBmdW5jdGlvbiAoW3gsIHldKSB7XG4gIHJldHVybiBbKHggKyBDb25zdHMuRElNX1gpICUgQ29uc3RzLkRJTV9YLCAoeSArIENvbnN0cy5ESU1fWSkgJSBDb25zdHMuRElNX1ldO1xufVxuXG5HYW1lLnByb3RvdHlwZS5jaGVja0NvbGxpc2lvbnMgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMubW92aW5nT2JqZWN0cy5mb3JFYWNoKG8gPT4ge1xuICAgIGlmICh0aGlzLnNoaXAuaXNDb2xsaWRlZFdpdGgobykpIHtcbiAgICAgIHRoaXMucmVsb2NhdGUodGhpcy5zaGlwKTtcbiAgICAgIHRoaXMuc2hpcC5yZXNldCgpO1xuICAgIH1cbiAgfSlcbiAgdGhpcy5idWxsZXRzLmZvckVhY2goYiA9PiB7XG4gICAgdGhpcy5tb3ZpbmdPYmplY3RzLmZvckVhY2gobyA9PiB7XG4gICAgICBpZiAoYi5pc0NvbGxpZGVkV2l0aChvKSkge1xuICAgICAgICB0aGlzLnJlbW92ZShvKTtcbiAgICAgICAgdGhpcy5yZW1vdmUoYik7XG4gICAgICB9XG4gICAgfSlcbiAgfSlcbn1cblxuR2FtZS5wcm90b3R5cGUuc3RlcCA9IGZ1bmN0aW9uICgpIHtcbiAgdGhpcy5tb3ZlT2JqZWN0cygpO1xuICB0aGlzLmNoZWNrQ29sbGlzaW9ucygpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7TW92aW5nT2JqZWN0fSBvYmplY3RcbiAqL1xuR2FtZS5wcm90b3R5cGUucmVsb2NhdGUgPSBmdW5jdGlvbiAob2JqZWN0KSB7XG4gIG9iamVjdC5wb3MgPSB0aGlzLnJhbmRvbVBvc2l0aW9uKCk7XG59XG5cbi8qKlxuICogQHJldHVybnMge0FycmF5PE1vdmluZ09iamVjdD59XG4gKi9cbkdhbWUucHJvdG90eXBlLmFsbE9iamVjdHMgPSBmdW5jdGlvbiAoKSB7XG4gIHJldHVybiBbLi4udGhpcy5tb3ZpbmdPYmplY3RzLCB0aGlzLnNoaXAsIC4uLnRoaXMuYnVsbGV0c107XG59XG5cbkdhbWUucHJvdG90eXBlLmlzT3V0T2ZCb3VuZHMgPSBmdW5jdGlvbihwb3MpIHtcbiAgY29uc3QgW3gsIHldID0gcG9zO1xuICByZXR1cm4geCA+IEdhbWUuRElNX1ggfHwgeCA8IDAgfHwgeSA+IEdhbWUuRElNX1kgfHwgeSA8IDA7XG59XG5cbkdhbWUuTlVNX0FTVEVST0lEUyA9IDIwO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWU7XG4iLCJjb25zdCBVdGlsID0ge1xuICBpbmhlcml0cyhDaGlsZENsYXNzLCBQYXJlbnRDbGFzcykge1xuICAgIGNvbnN0IFN1cnJvZ2F0ZSA9IGZ1bmN0aW9uKCkge307XG4gICAgU3Vycm9nYXRlLnByb3RvdHlwZSA9IFBhcmVudENsYXNzLnByb3RvdHlwZTtcbiAgICBDaGlsZENsYXNzLnByb3RvdHlwZSA9IG5ldyBTdXJyb2dhdGUoKTtcbiAgICBDaGlsZENsYXNzLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IENoaWxkQ2xhc3M7XG4gIH0sXG4gIHJhbmRvbVZlYyhsZW5ndGgpIHtcbiAgICBjb25zdCBkZWcgPSAyICogTWF0aC5QSSAqIE1hdGgucmFuZG9tKCk7XG4gICAgcmV0dXJuIFV0aWwuc2NhbGUoW01hdGguc2luKGRlZyksIE1hdGguY29zKGRlZyldLCBsZW5ndGgpO1xuICB9LFxuICAvLyBTY2FsZSB0aGUgbGVuZ3RoIG9mIGEgdmVjdG9yIGJ5IHRoZSBnaXZlbiBhbW91bnQuXG4gIHNjYWxlKHZlYywgbSkge1xuICAgIHJldHVybiBbdmVjWzBdICogbSwgdmVjWzFdICogbV07XG4gIH0sXG4gIC8qKlxuICAgKiBAcGFyYW0ge1tudW1iZXIsIG51bWJlcl19IHZlY3RvclxuICAgKi9cbiAgbWFnbml0dWRlU3FPZih2ZWN0b3IpIHtcbiAgICBjb25zdCBbeCwgeV0gPSB2ZWN0b3I7XG4gICAgcmV0dXJuIHggKiogMiArIHkgKiogMjtcbiAgfSxcbiAgLyoqXG4gICAqIEBwYXJhbSB7W251bWJlciwgbnVtYmVyXX0gdmVjdG9yXG4gICAqL1xuICBtYWduaXR1ZGVPZih2ZWN0b3IpIHtcbiAgICByZXR1cm4gTWF0aC5zcXJ0KHRoaXMubWFnbml0dWRlU3FPZih2ZWN0b3IpKTtcbiAgfSxcbiAgLyoqXG4gICAqIEBwYXJhbSB7W251bWJlciwgbnVtYmVyXX0gdmVjdG9yXG4gICAqIEByZXR1cm5zIHtbbnVtYmVyLCBudW1iZXJdfSB0aGUgdW5pdCB2ZWN0b3IuIEluIGNhc2Ugd2hlcmUgdGhlIHZlY3RvciBoYXMgYSBsZW5ndGggb2YgMCwgdGhlIG9yaWdpbmFsIHZlY3RvciB3aWxsIGJlIHJldHVybmVkXG4gICAqL1xuICB1bml0VmVjdG9yT2YodmVjdG9yKSB7XG4gICAgY29uc3QgbWFnbml0dWRlID0gdGhpcy5tYWduaXR1ZGVPZih2ZWN0b3IpO1xuICAgIHJldHVybiBtYWduaXR1ZGUgPyB0aGlzLnNjYWxlKHZlY3RvciwgMSAvIG1hZ25pdHVkZSkgOiB2ZWN0b3I7XG4gIH0sXG4gIC8qKlxuICAgKiBSZXR1cm5zIGFuIG5ldyB2ZWN0b3Igd2hpY2ggbGVuZ3RoIGlzIGBsZW5ndGhgIGxvbmdlciB0aGFuIHRoZSBwcm92aWRlZCB2ZWN0b3IuXG4gICAqIFdoZW4gZ2l2ZW4gYSAwIHZlY3RvciwgdGhpcyByZXR1cm5zIG51bGwuXG4gICAqXG4gICAqIEBwYXJhbSB7W251bWJlciwgbnVtYmVyXX0gdmVjdG9yIHRoZSByZWZlcmVuY2UgdmVjdG9yXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBsZW5ndGggdGhlIGxlbmd0aCB0byBleHRlbmRcbiAgICogQHJldHVybnMge1tudW1iZXIsIG51bWJlcl18bnVsbH1cbiAgICovXG4gIGV4dGVuZFZlY3Rvcih2ZWN0b3IsIGxlbmd0aCkge1xuICAgIGNvbnN0IG1hZ25pdHVkZSA9IHRoaXMubWFnbml0dWRlT2YodmVjdG9yKTtcbiAgICBpZiAobWFnbml0dWRlKSB7XG4gICAgICBjb25zdCBleHRlbmRlZE1hZ25pdHVkZSA9IG1hZ25pdHVkZSArIGxlbmd0aDtcbiAgICAgIHJldHVybiB0aGlzLnNjYWxlKHRoaXMuc2NhbGUodmVjdG9yLCAxIC8gbWFnbml0dWRlKSwgZXh0ZW5kZWRNYWduaXR1ZGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH0sXG4gIHJvdGF0ZSh2ZWN0b3IsIHRoZXRhKSB7XG4gICAgY29uc3QgW3gsIHldID0gdmVjdG9yO1xuICAgIGNvbnN0IHgyID0geCAqIE1hdGguY29zKHRoZXRhKSAtIHkgKiBNYXRoLnNpbih0aGV0YSk7XG4gICAgY29uc3QgeTIgPSB4ICogTWF0aC5zaW4odGhldGEpICsgeSAqIE1hdGguY29zKHRoZXRhKTtcbiAgICByZXR1cm4gW3gyLCB5Ml07XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVXRpbDtcbiIsIm1vZHVsZS5leHBvcnRzID0ge1xuICBESU1fWDogNzY4LFxuICBESU1fWTogNTEyLFxuICB3TWFzazogMGIxLFxuICBhTWFzazogMGIxMCxcbiAgc01hc2s6IDBiMTAwLFxuICBkTWFzazogMGIxMDAwLFxuICBzcGFjZU1hc2s6IDBiMTAwMDAsXG4gIFNQRUVEX0lOVEVSVkFMOiAwLjI1LFxufVxuIiwiY29uc3QgTW92aW5nT2JqZWN0ID0gcmVxdWlyZSgnLi9tb3Zpbmdfb2JqZWN0Jyk7XG5jb25zdCBVdGlsID0gcmVxdWlyZSgnLi91dGlscycpXG5cbmNvbnN0IEJ1bGxldCA9IGZ1bmN0aW9uKHtwb3MsIHZlbH0pIHtcbiAgTW92aW5nT2JqZWN0LmNhbGwodGhpcywge3BvcywgdmVsLCByYWRpdXM6IEJ1bGxldC5SQURJVVMsIGNvbG9yOiBCdWxsZXQuQ09MT1J9KTtcbiAgdGhpcy5pc1dyYXBwYWJsZSA9IGZhbHNlO1xufVxuXG5CdWxsZXQuUkFESVVTID0gMjtcbkJ1bGxldC5DT0xPUiA9IFwid2hpdGVcIjtcblxuVXRpbC5pbmhlcml0cyhCdWxsZXQsIE1vdmluZ09iamVjdCk7XG5cbkJ1bGxldC5wcm90b3R5cGUuaXNDb2xsaWRlZFdpdGggPSBmdW5jdGlvbihvdGhlck9iamVjdCkge1xuICBjb25zdCBbeDEsIHkxXSA9IHRoaXMucG9zO1xuICBjb25zdCBbeDIsIHkyXSA9IG90aGVyT2JqZWN0LnBvcztcbiAgcmV0dXJuIE1hdGguc3FydCgoeDEgLSB4MikgKiogMiArICh5MSAtIHkyKSAqKiAyKSA8IHRoaXMucmFkaXVzICsgb3RoZXJPYmplY3QucmFkaXVzO1xufVxuXG5cblxubW9kdWxlLmV4cG9ydHMgPSBCdWxsZXQ7IiwiY29uc3QgR2FtZVZpZXcgPSByZXF1aXJlKFwiLi9nYW1lX3ZpZXdcIik7XG5pbXBvcnQgJy4uL2Nzcy9zdHlsZS5zY3NzJztcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oKSB7XG4gICAgY29uc3QgZ2FtZSA9IG5ldyBHYW1lVmlldygpO1xuICAgIGdhbWUuc3RhcnQoKTtcbn0pXG5cbiIsImNvbnN0IEdhbWUgPSByZXF1aXJlKFwiLi9nYW1lXCIpO1xuY29uc3QgQ29uc3RzID0gcmVxdWlyZShcIi4vY29uc3RzXCIpXG5cbmNvbnN0IEdhbWVWaWV3ID0gZnVuY3Rpb24gKCkge1xuXG4gIGNvbnN0IGFwcENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXBwLWNvbnRhaW5lclwiKTtcblxuICB0aGlzLmdhbWUgPSBuZXcgR2FtZSgpO1xuXG4gIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG4gIGNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXG4gIGNvbnN0IGRwciA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvO1xuICBjYW52YXMud2lkdGggPSBDb25zdHMuRElNX1ggKiBkcHI7XG4gIGNhbnZhcy5oZWlnaHQgPSBDb25zdHMuRElNX1kgKiBkcHI7XG4gIGNhbnZhcy5pZCA9IFwibWFpbi1jYW52YXNcIjtcbiAgY29udGV4dC5zY2FsZShkcHIsIGRwcik7XG4gIGNhbnZhcy50YWJJbmRleCA9IDE7XG4gIGNhbnZhcy5hdXRvZm9jdXMgPSB0cnVlO1xuICBhcHBDb250YWluZXIuYXBwZW5kQ2hpbGQoY2FudmFzKTtcblxuICBjb25zdCBzd2l0Y2hNb2RlQWN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgIHN3aXRjaE1vZGVCdXR0b24uaW5uZXJUZXh0ID0gYFN3aXRjaCB0byAke3RoaXMuZ2V0Q29udHJvbE1vZGUoKX0gbW9kZWA7XG4gICAgdGhpcy5zZXRDb250cm9sTW9kZSh0aGlzLmdldENvbnRyb2xNb2RlKCkgPT09ICdwb2xhcicgPyAnY2FydGVzaWFuJyA6ICdwb2xhcicpO1xuICB9LmJpbmQodGhpcy5nYW1lKTtcblxuICBjb25zdCBzd2l0Y2hNb2RlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgc3dpdGNoTW9kZUJ1dHRvbi5vbmNsaWNrID0gc3dpdGNoTW9kZUFjdGlvbjtcbiAgc3dpdGNoTW9kZUJ1dHRvbi5pbm5lclRleHQgPSBgU3dpdGNoIHRvICR7dGhpcy5nYW1lLmdldENvbnRyb2xNb2RlKCkgPT09ICdwb2xhcicgPyAnY2FydGVzaWFuJyA6ICdwb2xhcid9IG1vZGVgO1xuICBhcHBDb250YWluZXIuYXBwZW5kQ2hpbGQoc3dpdGNoTW9kZUJ1dHRvbik7XG5cbiAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgdGhpcy5jYW52YXMgPSBjYW52YXM7XG5cbiAgY29uc3Qga2V5YmluZGluZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgc3dpdGNoIChldmVudC5rZXkpIHtcbiAgICAgICAgY2FzZSAndyc6XG4gICAgICAgICAgdGhpcy5rZXlTdGF0dXMgfD0gQ29uc3RzLndNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdhJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyB8PSBDb25zdHMuYU1hc2s7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3MnOlxuICAgICAgICAgIHRoaXMua2V5U3RhdHVzIHw9IENvbnN0cy5zTWFzaztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZCc6XG4gICAgICAgICAgdGhpcy5rZXlTdGF0dXMgfD0gQ29uc3RzLmRNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICcgJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyB8PSBDb25zdHMuc3BhY2VNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBzd2l0Y2ggKGV2ZW50LmtleSkge1xuICAgICAgICBjYXNlICd3JzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+Q29uc3RzLndNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdhJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+Q29uc3RzLmFNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+Q29uc3RzLnNNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdkJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+Q29uc3RzLmRNYXNrO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICcgJzpcbiAgICAgICAgICB0aGlzLmtleVN0YXR1cyAmPSB+Q29uc3RzLnNwYWNlTWFzaztcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRXNjYXBlJzpcbiAgICAgICAgICBzd2l0Y2hNb2RlQWN0aW9uKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSlcbiAgfS5iaW5kKHRoaXMuZ2FtZSk7XG5cbiAga2V5YmluZGluZ3MoKTtcblxufVxuXG5HYW1lVmlldy5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gIC8vIHRoaXMuYmluZEtleUhhbmRsZXJzKCk7XG4gIGNvbnN0IHJlZnJlc2ggPSAoKSA9PiB7XG4gICAgdGhpcy5nYW1lLnN0ZXAoKTtcbiAgICB0aGlzLmdhbWUuZHJhdyh0aGlzLmNvbnRleHQpO1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShyZWZyZXNoKTtcbiAgfVxuICByZWZyZXNoKCk7XG59XG5cbkdhbWVWaWV3LnByb3RvdHlwZS5iaW5kS2V5SGFuZGxlcnMgPSBmdW5jdGlvbiAoKSB7XG4gIGtleSgnVycsICgpID0+IHtcbiAgICB0aGlzLmdhbWUuc2hpcC5wb3dlcihbMCwgLTFdKTtcbiAgfSlcbiAga2V5KCdTJywgKCkgPT4ge1xuICAgIHRoaXMuZ2FtZS5zaGlwLnBvd2VyKFswLCAxXSk7XG4gIH0pXG4gIGtleSgnQScsICgpID0+IHtcbiAgICB0aGlzLmdhbWUuc2hpcC5wb3dlcihbLTEsIDBdKTtcbiAgfSlcbiAga2V5KCdEJywgKCkgPT4ge1xuICAgIHRoaXMuZ2FtZS5zaGlwLnBvd2VyKFsxLCAwXSk7XG4gIH0pXG4gIGtleShcInNwYWNlXCIsICgpID0+IHtcbiAgICB0aGlzLmdhbWUuc2hpcC5maXJlQnVsbGV0KCk7XG4gIH0pXG59XG5cbm1vZHVsZS5leHBvcnRzID0gR2FtZVZpZXc7XG4iLCJjb25zdCBVdGlsID0gcmVxdWlyZSgnLi91dGlscycpXG5jb25zdCBNb3ZpbmdPYmplY3QgPSByZXF1aXJlKCcuL21vdmluZ19vYmplY3QnKTtcblxuLyoqXG4gKlxuICogQHBhcmFtIHt7cG9zOiBbbnVtYmVyLCBudW1iZXJdfX0gcGFyYW0wIG9wdGlvbnNcbiAqL1xuY29uc3QgQXN0ZXJvaWQgPSBmdW5jdGlvbiAoeyBwb3MgfSkge1xuICBNb3ZpbmdPYmplY3QuY2FsbCh0aGlzLCB7XG4gICAgcG9zLFxuICAgIHZlbDogVXRpbC5yYW5kb21WZWMoTWF0aC5yYW5kb20oKSAqIDYgKyAxKSxcbiAgICBjb2xvcjogQXN0ZXJvaWQuQ09MT1IsXG4gICAgcmFkaXVzOiBBc3Rlcm9pZC5SQURJVVNcbiAgfSlcbn07XG5cbkFzdGVyb2lkLkNPTE9SID0gXCIjNjY2NjY2XCI7XG5Bc3Rlcm9pZC5SQURJVVMgPSAyMDtcblxuVXRpbC5pbmhlcml0cyhBc3Rlcm9pZCwgTW92aW5nT2JqZWN0KTtcblxubW9kdWxlLmV4cG9ydHMgPSBBc3Rlcm9pZDsiLCJjb25zdCBVdGlsID0gcmVxdWlyZShcIi4vdXRpbHNcIik7XG5jb25zdCBNb3ZpbmdPYmplY3QgPSByZXF1aXJlKFwiLi9tb3Zpbmdfb2JqZWN0XCIpO1xuY29uc3QgR2FtZSA9IHJlcXVpcmUoJy4vZ2FtZScpO1xuY29uc3QgQnVsbGV0ID0gcmVxdWlyZSgnLi9idWxsZXQnKTtcbmNvbnN0IENvbnN0ID0gcmVxdWlyZSgnLi9jb25zdHMnKVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge3twb3M6IFtudW1iZXIsIG51bWJlcl19fSBwYXJhbTAgb3B0aW9uc1xuICogQHBhcmFtIHtHYW1lfSBnYW1lXG4gKi9cbmNvbnN0IFNoaXAgPSBmdW5jdGlvbiAoe3Bvc30sIGdhbWUpIHtcbiAgTW92aW5nT2JqZWN0LmNhbGwodGhpcywge3BvcywgcmFkaXVzOiBTaGlwLlJBRElVUywgY29sb3I6IFNoaXAuQ09MT1IsIHZlbDogWzAsIDBdfSk7XG4gIHRoaXMuZ2FtZSA9IGdhbWU7XG4gIHRoaXMudXBkYXRlQ29udHJvbCgpO1xufVxuXG5TaGlwLlJBRElVUyA9IDE1O1xuU2hpcC5DT0xPUiA9IFwiIzMxYTVkOVwiO1xuVXRpbC5pbmhlcml0cyhTaGlwLCBNb3ZpbmdPYmplY3QpXG5cblNoaXAucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLnZlbCA9IFswLCAwXTtcbn1cblxuLyoqXG4gKiBAcGFyYW0ge01vdmluZ09iamVjdH0gb3RoZXJPYmplY3RcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5TaGlwLnByb3RvdHlwZS5pc0NvbGxpZGVkV2l0aCA9IGZ1bmN0aW9uIChvdGhlck9iamVjdCkge1xuXG4gIGNvbnN0IFt4MSwgeTFdID0gdGhpcy5wb3M7XG4gIGNvbnN0IFt4MiwgeTJdID0gb3RoZXJPYmplY3QucG9zO1xuICByZXR1cm4gTWF0aC5zcXJ0KCh4MSAtIHgyKSAqKiAyICsgKHkxIC0geTIpICoqIDIpIDwgdGhpcy5yYWRpdXMgKyBvdGhlck9iamVjdC5yYWRpdXM7XG59O1xuXG5TaGlwLnByb3RvdHlwZS51cGRhdGVDb250cm9sID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuY29udHJvbGxlciA9IGNvbnRyb2xTY2hlbWUodGhpcy5nYW1lLmdldENvbnRyb2xNb2RlKCkpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7bnVtYmVyfSBrZXlTdGF0dXNcbiAqL1xuU2hpcC5wcm90b3R5cGUuY29udHJvbCA9IGZ1bmN0aW9uIChrZXlTdGF0dXMpIHtcbiAgdGhpcy52ZWwgPSB0aGlzLmNvbnRyb2xsZXIoa2V5U3RhdHVzKTtcbn1cblxuU2hpcC5wcm90b3R5cGUuZmlyZUJ1bGxldCA9IGZ1bmN0aW9uICgpIHtcblxuICBjb25zdCBwb3MgPSB0aGlzLnBvcztcbiAgY29uc3QgdmVsID0gVXRpbC5leHRlbmRWZWN0b3IodGhpcy52ZWwsIDEwKSB8fCBbMCwgMTBdO1xuICBjb25zdCBidWxsZXQgPSBuZXcgQnVsbGV0KHtwb3MsIHZlbH0pO1xuXG4gIHRoaXMuZ2FtZS5hZGQoYnVsbGV0KTtcblxufVxuXG4vKipcbiAqIEdldCBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyBhIHNwZWVkIHZlY3RvciBiYXNlIG9uIHVzZXIgaW5wdXQuXG4gKlxuICogQHBhcmFtIHtcInBvbGFyXCJ8XCJjYXJ0ZXNpYW5cIn0gbW9kZVxuICovXG5mdW5jdGlvbiBjb250cm9sU2NoZW1lKG1vZGUpIHtcbiAgaWYgKG1vZGUgPT09IFwicG9sYXJcIikge1xuICAgIGxldCB0aGV0YSA9IDA7XG4gICAgbGV0IHNwZWVkID0gMDtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBrZXlTdGF0dXNcbiAgICAgKiBAcmV0dXJuIHtbbnVtYmVyLCBudW1iZXJdfVxuICAgICAqL1xuICAgIHJldHVybiAoa2V5U3RhdHVzKSA9PiB7XG4gICAgICBpZiAoa2V5U3RhdHVzICYgQ29uc3Qud01hc2spIHNwZWVkICs9IENvbnN0LlNQRUVEX0lOVEVSVkFMO1xuICAgICAgaWYgKGtleVN0YXR1cyAmIENvbnN0LmFNYXNrKSB0aGV0YSAtPSBDb25zdC5TUEVFRF9JTlRFUlZBTCAvIDI7XG4gICAgICBpZiAoa2V5U3RhdHVzICYgQ29uc3Quc01hc2spIHNwZWVkIC09IENvbnN0LlNQRUVEX0lOVEVSVkFMO1xuICAgICAgaWYgKGtleVN0YXR1cyAmIENvbnN0LmRNYXNrKSB0aGV0YSArPSBDb25zdC5TUEVFRF9JTlRFUlZBTCAvIDI7XG4gICAgICByZXR1cm4gVXRpbC5yb3RhdGUoVXRpbC5leHRlbmRWZWN0b3IoWzEsIDBdLCBzcGVlZCksIHRoZXRhKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbGV0IGR4ID0gMDtcbiAgICBsZXQgZHkgPSAwO1xuICAgIHJldHVybiAoa2V5U3RhdHVzKSA9PiB7XG4gICAgICBpZiAoa2V5U3RhdHVzICYgQ29uc3Qud01hc2spIGR5IC09IENvbnN0LlNQRUVEX0lOVEVSVkFMO1xuICAgICAgaWYgKGtleVN0YXR1cyAmIENvbnN0LmFNYXNrKSBkeCAtPSBDb25zdC5TUEVFRF9JTlRFUlZBTDtcbiAgICAgIGlmIChrZXlTdGF0dXMgJiBDb25zdC5zTWFzaykgZHkgKz0gQ29uc3QuU1BFRURfSU5URVJWQUw7XG4gICAgICBpZiAoa2V5U3RhdHVzICYgQ29uc3QuZE1hc2spIGR4ICs9IENvbnN0LlNQRUVEX0lOVEVSVkFMO1xuICAgICAgcmV0dXJuIFtkeCwgZHldO1xuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFNoaXA7XG4iXSwic291cmNlUm9vdCI6IiJ9